!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Jsrsasign",[],e):"object"==typeof exports?exports.Jsrsasign=e():t.Jsrsasign=e()}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){(function(e){function r(t,e,r){null!=t&&("number"==typeof t?this.fromNumber(t,e,r):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function n(){return new r(null)}function i(t,e,r,n,i,o){for(;--o>=0;){var s=e*this[t++]+r[n]+i;i=Math.floor(s/67108864),r[n++]=67108863&s}return i}function o(t,e,r,n,i,o){for(var s=32767&e,a=e>>15;--o>=0;){var h=32767&this[t],f=this[t++]>>15,u=a*h+f*s;h=s*h+((32767&u)<<15)+r[n]+(1073741823&i),i=(h>>>30)+(u>>>15)+a*f+(i>>>30),r[n++]=1073741823&h}return i}function s(t,e,r,n,i,o){for(var s=16383&e,a=e>>14;--o>=0;){var h=16383&this[t],f=this[t++]>>14,u=a*h+f*s;h=s*h+((16383&u)<<14)+r[n]+i,i=(h>>28)+(u>>14)+a*f,r[n++]=268435455&h}return i}function a(t){return Bt.charAt(t)}function h(t,e){var r=kt[t.charCodeAt(e)];return null==r?-1:r}function f(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s}function u(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0}function c(t){var e=n();return e.fromInt(t),e}function p(t,e){var n;if(16==e)n=4;else if(8==e)n=3;else if(256==e)n=8;else if(2==e)n=1;else if(32==e)n=5;else{if(4!=e)return void this.fromRadix(t,e);n=2}this.t=0,this.s=0;for(var i=t.length,o=!1,s=0;--i>=0;){var a=8==n?255&t[i]:h(t,i);a<0?"-"==t.charAt(i)&&(o=!0):(o=!1,0==s?this[this.t++]=a:s+n>this.DB?(this[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this[this.t++]=a>>this.DB-s):this[this.t-1]|=a<<s,s+=n,s>=this.DB&&(s-=this.DB))}8==n&&0!=(128&t[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),o&&r.ZERO.subTo(this,this)}function l(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function g(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var r,n=(1<<e)-1,i=!1,o="",s=this.t,h=this.DB-s*this.DB%e;if(s-- >0)for(h<this.DB&&(r=this[s]>>h)>0&&(i=!0,o=a(r));s>=0;)h<e?(r=(this[s]&(1<<h)-1)<<e-h,r|=this[--s]>>(h+=this.DB-e)):(r=this[s]>>(h-=e)&n,h<=0&&(h+=this.DB,--s)),r>0&&(i=!0),i&&(o+=a(r));return i?o:"0"}function d(){var t=n();return r.ZERO.subTo(this,t),t}function y(){return this.s<0?this.negate():this}function v(t){var e=this.s-t.s;if(0!=e)return e;var r=this.t;if(e=r-t.t,0!=e)return this.s<0?-e:e;for(;--r>=0;)if(0!=(e=this[r]-t[r]))return e;return 0}function S(t){var e,r=1;return 0!=(e=t>>>16)&&(t=e,r+=16),0!=(e=t>>8)&&(t=e,r+=8),0!=(e=t>>4)&&(t=e,r+=4),0!=(e=t>>2)&&(t=e,r+=2),0!=(e=t>>1)&&(t=e,r+=1),r}function A(){return this.t<=0?0:this.DB*(this.t-1)+S(this[this.t-1]^this.s&this.DM)}function m(t,e){var r;for(r=this.t-1;r>=0;--r)e[r+t]=this[r];for(r=t-1;r>=0;--r)e[r]=0;e.t=this.t+t,e.s=this.s}function E(t,e){for(var r=t;r<this.t;++r)e[r-t]=this[r];e.t=Math.max(this.t-t,0),e.s=this.s}function w(t,e){var r,n=t%this.DB,i=this.DB-n,o=(1<<i)-1,s=Math.floor(t/this.DB),a=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)e[r+s+1]=this[r]>>i|a,a=(this[r]&o)<<n;for(r=s-1;r>=0;--r)e[r]=0;e[s]=a,e.t=this.t+s+1,e.s=this.s,e.clamp()}function P(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t)return void(e.t=0);var n=t%this.DB,i=this.DB-n,o=(1<<n)-1;e[0]=this[r]>>n;for(var s=r+1;s<this.t;++s)e[s-r-1]|=(this[s]&o)<<i,e[s-r]=this[s]>>n;n>0&&(e[this.t-r-1]|=(this.s&o)<<i),e.t=this.t-r,e.clamp()}function b(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this[r]-t[r],e[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this[r],e[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t[r],e[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e[r++]=this.DV+n:n>0&&(e[r++]=n),e.t=r,e.clamp()}function H(t,e){var n=this.abs(),i=t.abs(),o=n.t;for(e.t=o+i.t;--o>=0;)e[o]=0;for(o=0;o<i.t;++o)e[o+n.t]=n.am(0,i[o],e,o,0,n.t);e.s=0,e.clamp(),this.s!=t.s&&r.ZERO.subTo(e,e)}function x(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e[r],t,2*r,0,1);(t[r+e.t]+=e.am(r+1,2*e[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t[r+e.t]-=e.DV,t[r+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(r,e[r],t,2*r,0,1)),t.s=0,t.clamp()}function C(t,e,i){var o=t.abs();if(!(o.t<=0)){var s=this.abs();if(s.t<o.t)return null!=e&&e.fromInt(0),void(null!=i&&this.copyTo(i));null==i&&(i=n());var a=n(),h=this.s,f=t.s,u=this.DB-S(o[o.t-1]);u>0?(o.lShiftTo(u,a),s.lShiftTo(u,i)):(o.copyTo(a),s.copyTo(i));var c=a.t,p=a[c-1];if(0!=p){var l=p*(1<<this.F1)+(c>1?a[c-2]>>this.F2:0),g=this.FV/l,d=(1<<this.F1)/l,y=1<<this.F2,v=i.t,A=v-c,m=null==e?n():e;for(a.dlShiftTo(A,m),i.compareTo(m)>=0&&(i[i.t++]=1,i.subTo(m,i)),r.ONE.dlShiftTo(c,m),m.subTo(a,a);a.t<c;)a[a.t++]=0;for(;--A>=0;){var E=i[--v]==p?this.DM:Math.floor(i[v]*g+(i[v-1]+y)*d);if((i[v]+=a.am(0,E,i,A,0,c))<E)for(a.dlShiftTo(A,m),i.subTo(m,i);i[v]<--E;)i.subTo(m,i)}null!=e&&(i.drShiftTo(c,e),h!=f&&r.ZERO.subTo(e,e)),i.t=c,i.clamp(),u>0&&i.rShiftTo(u,i),h<0&&r.ZERO.subTo(i,i)}}}function R(t){var e=n();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(r.ZERO)>0&&t.subTo(e,e),e}function D(t){this.m=t}function N(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function O(t){return t}function K(t){t.divRemTo(this.m,null,t)}function j(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function T(t,e){t.squareTo(e),this.reduce(e)}function I(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return e=e*(2-(15&t)*e)&15,e=e*(2-(255&t)*e)&255,e=e*(2-((65535&t)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function M(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function _(t){var e=n();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(r.ZERO)>0&&this.m.subTo(e,e),e}function B(t){var e=n();return t.copyTo(e),this.reduce(e),e}function k(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=32767&t[e],n=r*this.mpl+((r*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t[r]+=this.m.am(0,n,t,e,0,this.m.t);t[r]>=t.DV;)t[r]-=t.DV,t[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function U(t,e){t.squareTo(e),this.reduce(e)}function F(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function V(){return 0==(this.t>0?1&this[0]:this.s)}function L(t,e){if(t>4294967295||t<1)return r.ONE;var i=n(),o=n(),s=e.convert(this),a=S(t)-1;for(s.copyTo(i);--a>=0;)if(e.sqrTo(i,o),(t&1<<a)>0)e.mulTo(o,s,i);else{var h=i;i=o,o=h}return e.revert(i)}function Y(t,e){var r;return r=t<256||e.isEven()?new D(e):new M(e),this.exp(t,r)}function X(t){var e,r,n="";for(e=0;e+3<=t.length;e+=3)r=parseInt(t.substring(e,e+3),16),n+=Ft.charAt(r>>6)+Ft.charAt(63&r);if(e+1==t.length?(r=parseInt(t.substring(e,e+1),16),n+=Ft.charAt(r<<2)):e+2==t.length&&(r=parseInt(t.substring(e,e+2),16),n+=Ft.charAt(r>>2)+Ft.charAt((3&r)<<4)),Vt)for(;(3&n.length)>0;)n+=Vt;return n}function J(t){var e,r,n,i="",o=0;for(e=0;e<t.length&&t.charAt(e)!=Vt;++e)n=Ft.indexOf(t.charAt(e)),n<0||(0==o?(i+=a(n>>2),r=3&n,o=1):1==o?(i+=a(r<<2|n>>4),r=15&n,o=2):2==o?(i+=a(r),i+=a(n>>2),r=3&n,o=3):(i+=a(r<<2|n>>4),i+=a(15&n),o=0));return 1==o&&(i+=a(r<<2)),i}function W(t){for(var e=new Array,r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}function q(t){for(var e="",r=0;r<t.length;r++){var n=t[r].toString(16);1==n.length&&(n="0"+n),e+=n}return e}function G(t){return q(W(t))}function z(t){return t=t.replace(/\=/g,""),t=t.replace(/\+/g,"-"),t=t.replace(/\//g,"_")}function $(t){return t.length%4==2?t+="==":t.length%4==3&&(t+="="),t=t.replace(/-/g,"+"),t=t.replace(/_/g,"/")}function Z(t){return t.length%2==1&&(t="0"+t),z(X(t))}function Q(t){return J($(t))}function tt(t){return nt(ot(t))}function et(t){for(var e="",r=0;r<t.length-1;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e}function rt(t){for(var e="",r=0;r<t.length;r++)e+=("0"+t.charCodeAt(r).toString(16)).slice(-2);return e}function nt(t){return t.replace(/%/g,"")}function it(t){return t.replace(/(..)/g,"%$1")}function ot(t){for(var e=encodeURIComponent(t),r="",n=0;n<e.length;n++)"%"==e[n]?(r+=e.substr(n,3),n+=2):r=r+"%"+G(e[n]);return r}/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
	 */
function st(t,e){return new r(t,e)}function at(t,e){if(e<t.length+11)return alert("Message too long for RSA"),null;for(var n=new Array,i=t.length-1;i>=0&&e>0;){var o=t.charCodeAt(i--);o<128?n[--e]=o:o>127&&o<2048?(n[--e]=63&o|128,n[--e]=o>>6|192):(n[--e]=63&o|128,n[--e]=o>>6&63|128,n[--e]=o>>12|224)}n[--e]=0;for(var s=new SecureRandom,a=new Array;e>2;){for(a[0]=0;0==a[0];)s.nextBytes(a);n[--e]=a[0]}return n[--e]=2,n[--e]=0,new r(n)}function ht(t,e,r){for(var n="",i=0;n.length<e;)n+=r(String.fromCharCode.apply(String,t.concat([(4278190080&i)>>24,(16711680&i)>>16,(65280&i)>>8,255&i]))),i+=1;return n}function ft(t,e,n,i){var o=Ut.crypto.MessageDigest,s=Ut.crypto.Util,a=null;if(n||(n="sha1"),"string"==typeof n&&(a=o.getCanonicalAlgName(n),i=o.getHashLength(a),n=function(t){return et(s.hashString(t,a))}),t.length+2*i+2>e)throw"Message too long for RSA";var h,f="";for(h=0;h<e-t.length-2*i-2;h+=1)f+="\0";var u=n("")+f+""+t,c=new Array(i);(new SecureRandom).nextBytes(c);var p=ht(c,u.length,n),l=[];for(h=0;h<u.length;h+=1)l[h]=u.charCodeAt(h)^p.charCodeAt(h);var g=ht(l,c.length,n),d=[0];for(h=0;h<c.length;h+=1)d[h+1]=c[h]^g.charCodeAt(h);return new r(d.concat(l))}function ut(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function ct(t,e){this.isPublic=!0,"string"!=typeof t?(this.n=t,this.e=e):null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=st(t,16),this.e=parseInt(e,16)):alert("Invalid RSA public key")}function pt(t){return t.modPowInt(this.e,this.n)}function lt(t){var e=at(t,this.n.bitLength()+7>>3);if(null==e)return null;var r=this.doPublic(e);if(null==r)return null;var n=r.toString(16);return 0==(1&n.length)?n:"0"+n}function gt(t,e,r){var n=ft(t,this.n.bitLength()+7>>3,e,r);if(null==n)return null;var i=this.doPublic(n);if(null==i)return null;var o=i.toString(16);return 0==(1&o.length)?o:"0"+o}function dt(t,e){for(var r="",n=e/4-t.length,i=0;i<n;i++)r+="0";return r+t}function yt(t,e){var r=function(t){return Ut.crypto.Util.hashString(t,e)},n=r(t);return this.signWithMessageHash(n,e)}function vt(t,e){var r=Ut.crypto.Util.getPaddedDigestInfoHex(t,e,this.n.bitLength()),n=st(r,16),i=this.doPrivate(n),o=i.toString(16);return dt(o,this.n.bitLength())}function St(t){return yt.call(this,t,"sha1")}function At(t){return yt.call(this,t,"sha256")}function mt(t,e,r){for(var n="",i=0;n.length<e;)n+=et(r(rt(t+String.fromCharCode.apply(String,[(4278190080&i)>>24,(16711680&i)>>16,(65280&i)>>8,255&i])))),i+=1;return n}function Et(t,e,r){var n=function(t){return Ut.crypto.Util.hashHex(t,e)},i=n(rt(t));return void 0===r&&(r=-1),this.signWithMessageHashPSS(i,e,r)}function wt(t,e,n){var i,o=et(t),s=o.length,a=this.n.bitLength()-1,h=Math.ceil(a/8),f=function(t){return Ut.crypto.Util.hashHex(t,e)};if(n===-1||void 0===n)n=s;else if(n===-2)n=h-s-2;else if(n<-2)throw"invalid salt length";if(h<s+n+2)throw"data too long";var u="";n>0&&(u=new Array(n),(new SecureRandom).nextBytes(u),u=String.fromCharCode.apply(String,u));var c=et(f(rt("\0\0\0\0\0\0\0\0"+o+u))),p=[];for(i=0;i<h-n-s-2;i+=1)p[i]=0;var l=String.fromCharCode.apply(String,p)+""+u,g=mt(c,l.length,f),d=[];for(i=0;i<l.length;i+=1)d[i]=l.charCodeAt(i)^g.charCodeAt(i);var y=65280>>8*h-a&255;for(d[0]&=~y,i=0;i<s;i++)d.push(c.charCodeAt(i));return d.push(188),dt(this.doPrivate(new r(d)).toString(16),this.n.bitLength())}function Pt(t,e,r){var n=new ut;n.setPublic(e,r);var i=n.doPublic(t);return i}function bt(t,e,r){var n=Pt(t,e,r),i=n.toString(16).replace(/^1f+00/,"");return i}function Ht(t){for(var e in Ut.crypto.Util.DIGESTINFOHEAD){var r=Ut.crypto.Util.DIGESTINFOHEAD[e],n=r.length;if(t.substring(0,n)==r){var i=[e,t.substring(n)];return i}}return[]}function xt(t,e,r,n){var i=bt(e,r,n),o=Ht(i);if(0==o.length)return!1;var s=o[0],a=o[1],h=function(t){return Ut.crypto.Util.hashString(t,s)},f=h(t);return a==f}function Ct(t,e){var r=st(t,16),n=xt(e,r,this.n.toString(16),this.e.toString(16));return n}function Rt(t,e){e=e.replace(qt,""),e=e.replace(/[ \n]+/g,"");var r=st(e,16);if(r.bitLength()>this.n.bitLength())return 0;var n=this.doPublic(r),i=n.toString(16).replace(/^1f+00/,""),o=Ht(i);if(0==o.length)return!1;var s=o[0],a=o[1],h=function(t){return Ut.crypto.Util.hashString(t,s)},f=h(t);return a==f}function Dt(t,e){e=e.replace(qt,""),e=e.replace(/[ \n]+/g,"");var r=st(e,16);if(r.bitLength()>this.n.bitLength())return 0;var n=this.doPublic(r),i=n.toString(16).replace(/^1f+00/,""),o=Ht(i);if(0==o.length)return!1;var s=(o[0],o[1]);return s==t}function Nt(t,e,r,n){var i=function(t){return Ut.crypto.Util.hashHex(t,r)},o=i(rt(t));return void 0===n&&(n=-1),this.verifyWithMessageHashPSS(o,e,r,n)}function Ot(t,e,n,i){var o=new r(e,16);if(o.bitLength()>this.n.bitLength())return!1;var s,a=function(t){return Ut.crypto.Util.hashHex(t,n)},h=et(t),f=h.length,u=this.n.bitLength()-1,c=Math.ceil(u/8);if(i===-1||void 0===i)i=f;else if(i===-2)i=c-f-2;else if(i<-2)throw"invalid salt length";if(c<f+i+2)throw"data too long";var p=this.doPublic(o).toByteArray();for(s=0;s<p.length;s+=1)p[s]&=255;for(;p.length<c;)p.unshift(0);if(188!==p[c-1])throw"encoded message does not end in 0xbc";p=String.fromCharCode.apply(String,p);var l=p.substr(0,c-f-1),g=p.substr(l.length,f),d=65280>>8*c-u&255;if(0!==(l.charCodeAt(0)&d))throw"bits beyond keysize not zero";var y=mt(g,l.length,a),v=[];for(s=0;s<l.length;s+=1)v[s]=l.charCodeAt(s)^y.charCodeAt(s);v[0]&=~d;var S=c-f-i-2;for(s=0;s<S;s+=1)if(0!==v[s])throw"leftmost octets not zero";if(1!==v[S])throw"0x01 marker not found";return g===et(a(rt("\0\0\0\0\0\0\0\0"+h+String.fromCharCode.apply(String,v.slice(-i)))))}/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
	 */
var Kt,jt=0xdeadbeefcafe,Tt=15715070==(16777215&jt);Tt&&"Microsoft Internet Explorer"==navigator.appName?(r.prototype.am=o,Kt=30):Tt&&"Netscape"!=navigator.appName?(r.prototype.am=i,Kt=26):(r.prototype.am=s,Kt=28),r.prototype.DB=Kt,r.prototype.DM=(1<<Kt)-1,r.prototype.DV=1<<Kt;var It=52;r.prototype.FV=Math.pow(2,It),r.prototype.F1=It-Kt,r.prototype.F2=2*Kt-It;var Mt,_t,Bt="0123456789abcdefghijklmnopqrstuvwxyz",kt=new Array;for(Mt="0".charCodeAt(0),_t=0;_t<=9;++_t)kt[Mt++]=_t;for(Mt="a".charCodeAt(0),_t=10;_t<36;++_t)kt[Mt++]=_t;for(Mt="A".charCodeAt(0),_t=10;_t<36;++_t)kt[Mt++]=_t;D.prototype.convert=N,D.prototype.revert=O,D.prototype.reduce=K,D.prototype.mulTo=j,D.prototype.sqrTo=T,M.prototype.convert=_,M.prototype.revert=B,M.prototype.reduce=k,M.prototype.mulTo=F,M.prototype.sqrTo=U,r.prototype.copyTo=f,r.prototype.fromInt=u,r.prototype.fromString=p,r.prototype.clamp=l,r.prototype.dlShiftTo=m,r.prototype.drShiftTo=E,r.prototype.lShiftTo=w,r.prototype.rShiftTo=P,r.prototype.subTo=b,r.prototype.multiplyTo=H,r.prototype.squareTo=x,r.prototype.divRemTo=C,r.prototype.invDigit=I,r.prototype.isEven=V,r.prototype.exp=L,r.prototype.toString=g,r.prototype.negate=d,r.prototype.abs=y,r.prototype.compareTo=v,r.prototype.bitLength=A,r.prototype.mod=R,r.prototype.modPowInt=Y,r.ZERO=c(0),r.ONE=c(1);/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
	 */
var Ut,Ft="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Vt="=",Lt=function(){function t(t,e,r){return e?s[e]:String.fromCharCode(parseInt(r,16))}var e="(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)",r='(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))',n='(?:"'+r+'*")',i=new RegExp("(?:false|true|null|[\\{\\}\\[\\]]|"+e+"|"+n+")","g"),o=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),s={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},a=new String(""),h="\\",f=({"{":Object,"[":Array},Object.hasOwnProperty);return function(e,r){var n,s=e.match(i),u=s[0],c=!1;"{"===u?n={}:"["===u?n=[]:(n=[],c=!0);for(var p,l=[n],g=1-c,d=s.length;g<d;++g){u=s[g];var y;switch(u.charCodeAt(0)){default:y=l[0],y[p||y.length]=+u,p=void 0;break;case 34:if(u=u.substring(1,u.length-1),u.indexOf(h)!==-1&&(u=u.replace(o,t)),y=l[0],!p){if(!(y instanceof Array)){p=u||a;break}p=y.length}y[p]=u,p=void 0;break;case 91:y=l[0],l.unshift(y[p||y.length]=[]),p=void 0;break;case 93:l.shift();break;case 102:y=l[0],y[p||y.length]=!1,p=void 0;break;case 110:y=l[0],y[p||y.length]=null,p=void 0;break;case 116:y=l[0],y[p||y.length]=!0,p=void 0;break;case 123:y=l[0],l.unshift(y[p||y.length]={}),p=void 0;break;case 125:l.shift()}}if(c){if(1!==l.length)throw new Error;n=n[0]}else if(l.length)throw new Error;if(r){var v=function(t,e){var n=t[e];if(n&&"object"==typeof n){var i=null;for(var o in n)if(f.call(n,o)&&n!==t){var s=v(n,o);void 0!==s?n[o]=s:(i||(i=[]),i.push(o))}if(i)for(var a=i.length;--a>=0;)delete n[i[a]]}return r.call(t,e,n)};n=v({"":n},"")}return n}}();"undefined"!=typeof Ut&&Ut||(Ut={}),"undefined"!=typeof Ut.lang&&Ut.lang||(Ut.lang={}),Ut.lang.String=function(){};var Yt,Xt;"function"==typeof e?(Yt=function(t){return z(new e(t,"utf8").toString("base64"))},Xt=function(t){return new e($(t),"base64").toString("utf8")}):(Yt=function(t){return Z(nt(ot(t)))},Xt=function(t){return decodeURIComponent(it(Q(t)))}),Ut.lang.String.isInteger=function(t){return!!t.match(/^[0-9]+$/)||!!t.match(/^-[0-9]+$/)},Ut.lang.String.isHex=function(t){return!(t.length%2!=0||!t.match(/^[0-9a-f]+$/)&&!t.match(/^[0-9A-F]+$/))},Ut.lang.String.isBase64=function(t){return t=t.replace(/\s+/g,""),!(!t.match(/^[0-9A-Za-z+\/]+={0,3}$/)||t.length%4!=0)},Ut.lang.String.isBase64URL=function(t){return!t.match(/[+\/=]/)&&(t=$(t),Ut.lang.String.isBase64(t))},Ut.lang.String.isIntegerArray=function(t){return t=t.replace(/\s+/g,""),!!t.match(/^\[[0-9,]+\]$/)};/*! jws-3.3.5 (c) 2013-2016 Kenji Urushima | kjur.github.com/jsrsasign/license
	 */
/**
	 * @fileOverview
	 * @name jws-3.3.js
	 * @author Kenji Urushima kenji.urushima@gmail.com
	 * @version 3.3.5 (2016-Oct-08)
	 * @since jsjws 1.0, jsrsasign 4.8.0
	 * @license <a href="http://kjur.github.io/jsrsasign/license/">MIT License</a>
	 */
"undefined"!=typeof Ut&&Ut||(Ut={}),"undefined"!=typeof Ut.jws&&Ut.jws||(Ut.jws={}),Ut.jws.JWS=function(){var t=Ut.jws.JWS;this.parseJWS=function(e,r){if(void 0===this.parsedJWS||!r&&void 0===this.parsedJWS.sigvalH){var n=e.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(null==n)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var i=n[1],o=n[2],s=n[3],a=i+"."+o;if(this.parsedJWS={},this.parsedJWS.headB64U=i,this.parsedJWS.payloadB64U=o,this.parsedJWS.sigvalB64U=s,this.parsedJWS.si=a,!r){var h=Q(s),f=st(h,16);this.parsedJWS.sigvalH=h,this.parsedJWS.sigvalBI=f}var u=Xt(i),c=Xt(o);if(this.parsedJWS.headS=u,this.parsedJWS.payloadS=c,!t.isSafeJSONString(u,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+u}}},Ut.jws.JWS.sign=function(t,e,r,n,i){var o,s,a,h=Ut.jws.JWS;if("string"!=typeof e&&"object"!=typeof e)throw"spHeader must be JSON string or object: "+e;if("object"==typeof e&&(s=e,o=JSON.stringify(s)),"string"==typeof e){if(o=e,!h.isSafeJSONString(o))throw"JWS Head is not safe JSON string: "+o;s=h.readSafeJSONString(o)}if(a=r,"object"==typeof r&&(a=JSON.stringify(r)),""!=t&&null!=t||void 0===s.alg||(t=s.alg),""!=t&&null!=t&&void 0===s.alg&&(s.alg=t,o=JSON.stringify(s)),t!==s.alg)throw"alg and sHeader.alg doesn't match: "+t+"!="+s.alg;var f=null;if(void 0===h.jwsalg2sigalg[t])throw"unsupported alg name: "+t;f=h.jwsalg2sigalg[t];var u=Yt(o),c=Yt(a),p=u+"."+c,l="";if("Hmac"==f.substr(0,4)){if(void 0===n)throw"mac key shall be specified for HS* alg";var g=new Ut.crypto.Mac({alg:f,prov:"cryptojs",pass:n});g.updateString(p),l=g.doFinal()}else if(f.indexOf("withECDSA")!=-1){var d=new Ut.crypto.Signature({alg:f});d.init(n,i),d.updateString(p),hASN1Sig=d.sign(),l=Ut.crypto.ECDSA.asn1SigToConcatSig(hASN1Sig)}else if("none"!=f){var d=new Ut.crypto.Signature({alg:f});d.init(n,i),d.updateString(p),l=d.sign()}var y=Z(l);return p+"."+y},Ut.jws.JWS.verify=function(t,e,r){var n=Ut.jws.JWS,i=t.split("."),o=i[0],s=i[1],a=o+"."+s,h=Q(i[2]),f=n.readSafeJSONString(Xt(i[0])),u=null,c=null;if(void 0===f.alg)throw"algorithm not specified in header";if(u=f.alg,c=u.substr(0,2),null!=r&&"[object Array]"===Object.prototype.toString.call(r)&&r.length>0){var p=":"+r.join(":")+":";if(p.indexOf(":"+u+":")==-1)throw"algorithm '"+u+"' not accepted in the list"}if("none"!=u&&null===e)throw"key shall be specified to verify.";if("string"==typeof e&&e.indexOf("-----BEGIN ")!=-1&&(e=Wt.getKey(e)),!("RS"!=c&&"PS"!=c||e instanceof ut))throw"key shall be a RSAKey obj for RS* and PS* algs";if("ES"==c&&!(e instanceof Ut.crypto.ECDSA))throw"key shall be a ECDSA obj for ES* algs";var l=null;if(void 0===n.jwsalg2sigalg[f.alg])throw"unsupported alg name: "+u;if(l=n.jwsalg2sigalg[u],"none"==l)throw"not supported";if("Hmac"==l.substr(0,4)){var g=null;if(void 0===e)throw"hexadecimal key shall be specified for HMAC";var d=new Ut.crypto.Mac({alg:l,pass:e});return d.updateString(a),g=d.doFinal(),h==g}if(l.indexOf("withECDSA")!=-1){var y=null;try{y=Ut.crypto.ECDSA.concatSigToASN1Sig(h)}catch(t){return!1}var v=new Ut.crypto.Signature({alg:l});return v.init(e),v.updateString(a),v.verify(y)}var v=new Ut.crypto.Signature({alg:l});return v.init(e),v.updateString(a),v.verify(h)},Ut.jws.JWS.parse=function(t){var e,r,n,i=t.split("."),o={};if(2!=i.length&&3!=i.length)throw"malformed sJWS: wrong number of '.' splitted elements";return e=i[0],r=i[1],3==i.length&&(n=i[2]),o.headerObj=Ut.jws.JWS.readSafeJSONString(Xt(e)),o.payloadObj=Ut.jws.JWS.readSafeJSONString(Xt(r)),o.headerPP=JSON.stringify(o.headerObj,null,"  "),null==o.payloadObj?o.payloadPP=Xt(r):o.payloadPP=JSON.stringify(o.payloadObj,null,"  "),void 0!==n&&(o.sigHex=Q(n)),o},Ut.jws.JWS.verifyJWT=function(t,e,r){var n=Ut.jws.JWS,i=t.split("."),o=i[0],s=i[1],a=(Q(i[2]),n.readSafeJSONString(Xt(o))),h=n.readSafeJSONString(Xt(s));if(void 0===a.alg)return!1;if(void 0===r.alg)throw"acceptField.alg shall be specified";if(!n.inArray(a.alg,r.alg))return!1;if(void 0!==h.iss&&"object"==typeof r.iss&&!n.inArray(h.iss,r.iss))return!1;if(void 0!==h.sub&&"object"==typeof r.sub&&!n.inArray(h.sub,r.sub))return!1;if(void 0!==h.aud&&"object"==typeof r.aud)if("string"==typeof h.aud){if(!n.inArray(h.aud,r.aud))return!1}else if("object"==typeof h.aud&&!n.includedArray(h.aud,r.aud))return!1;var f=Ut.jws.IntDate.getNow();return void 0!==r.verifyAt&&"number"==typeof r.verifyAt&&(f=r.verifyAt),void 0!==r.gracePeriod&&"number"==typeof r.gracePeriod||(r.gracePeriod=0),!(void 0!==h.exp&&"number"==typeof h.exp&&h.exp+r.gracePeriod<f)&&(!(void 0!==h.nbf&&"number"==typeof h.nbf&&f<h.nbf-r.gracePeriod)&&(!(void 0!==h.iat&&"number"==typeof h.iat&&f<h.iat-r.gracePeriod)&&((void 0===h.jti||void 0===r.jti||h.jti===r.jti)&&!!Ut.jws.JWS.verify(t,e,r.alg))))},Ut.jws.JWS.includedArray=function(t,e){var r=Ut.jws.JWS.inArray;if(null===t)return!1;if("object"!=typeof t)return!1;if("number"!=typeof t.length)return!1;for(var n=0;n<t.length;n++)if(!r(t[n],e))return!1;return!0},Ut.jws.JWS.inArray=function(t,e){if(null===e)return!1;if("object"!=typeof e)return!1;if("number"!=typeof e.length)return!1;for(var r=0;r<e.length;r++)if(e[r]==t)return!0;return!1},Ut.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},Ut.jws.JWS.isSafeJSONString=function(t,e,r){var n=null;try{return n=Lt(t),"object"!=typeof n?0:n.constructor===Array?0:(e&&(e[r]=n),1)}catch(t){return 0}},Ut.jws.JWS.readSafeJSONString=function(t){var e=null;try{return e=Lt(t),"object"!=typeof e?null:e.constructor===Array?null:e}catch(t){return null}},Ut.jws.JWS.getEncodedSignatureValueFromJWS=function(t){var e=t.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(null==e)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return e[1]},Ut.jws.JWS.getJWKthumbprint=function(t){if("RSA"!==t.kty&&"EC"!==t.kty&&"oct"!==t.kty)throw"unsupported algorithm for JWK Thumprint";var e="{";if("RSA"===t.kty){if("string"!=typeof t.n||"string"!=typeof t.e)throw"wrong n and e value for RSA key";e+='"e":"'+t.e+'",',e+='"kty":"'+t.kty+'",',e+='"n":"'+t.n+'"}'}else if("EC"===t.kty){if("string"!=typeof t.crv||"string"!=typeof t.x||"string"!=typeof t.y)throw"wrong crv, x and y value for EC key";e+='"crv":"'+t.crv+'",',e+='"kty":"'+t.kty+'",',e+='"x":"'+t.x+'",',e+='"y":"'+t.y+'"}'}else if("oct"===t.kty){if("string"!=typeof t.k)throw"wrong k value for oct(symmetric) key";e+='"kty":"'+t.kty+'",',e+='"k":"'+t.k+'"}'}var r=rt(e),n=Ut.crypto.Util.hashHex(r,"sha256"),i=Z(n);return i},Ut.jws.IntDate={},Ut.jws.IntDate.get=function(t){if("now"==t)return Ut.jws.IntDate.getNow();if("now + 1hour"==t)return Ut.jws.IntDate.getNow()+3600;if("now + 1day"==t)return Ut.jws.IntDate.getNow()+86400;if("now + 1month"==t)return Ut.jws.IntDate.getNow()+2592e3;if("now + 1year"==t)return Ut.jws.IntDate.getNow()+31536e3;if(t.match(/Z$/))return Ut.jws.IntDate.getZulu(t);if(t.match(/^[0-9]+$/))return parseInt(t);throw"unsupported format: "+t},Ut.jws.IntDate.getZulu=function(t){var e=t.match(/(\d+)(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)Z/);if(e){var r=e[1],n=parseInt(r);if(4==r.length);else{if(2!=r.length)throw"malformed year string";if(50<=n&&n<100)n=1900+n;else{if(!(0<=n&&n<50))throw"malformed year string for UTCTime";n=2e3+n}}var i=parseInt(e[2])-1,o=parseInt(e[3]),s=parseInt(e[4]),a=parseInt(e[5]),h=parseInt(e[6]),f=new Date(Date.UTC(n,i,o,s,a,h));return~~(f/1e3)}throw"unsupported format: "+t},Ut.jws.IntDate.getNow=function(){var t=~~(new Date/1e3);return t},Ut.jws.IntDate.intDate2UTCString=function(t){var e=new Date(1e3*t);return e.toUTCString()},Ut.jws.IntDate.intDate2Zulu=function(t){var e=new Date(1e3*t),r=("0000"+e.getUTCFullYear()).slice(-4),n=("00"+(e.getUTCMonth()+1)).slice(-2),i=("00"+e.getUTCDate()).slice(-2),o=("00"+e.getUTCHours()).slice(-2),s=("00"+e.getUTCMinutes()).slice(-2),a=("00"+e.getUTCSeconds()).slice(-2);return r+n+i+o+s+a+"Z"},ut.prototype.doPublic=pt,ut.prototype.setPublic=ct,ut.prototype.encrypt=lt,ut.prototype.encryptOAEP=gt,ut.prototype.type="RSA";/*! CryptoJS v3.1.2 core-fix.js
	 * code.google.com/p/crypto-js
	 * (c) 2009-2013 by Jeff Mott. All rights reserved.
	 * code.google.com/p/crypto-js/wiki/License
	 * THIS IS FIX of 'core.js' to fix Hmac issue.
	 * https://code.google.com/p/crypto-js/issues/detail?id=84
	 * https://crypto-js.googlecode.com/svn-history/r667/branches/3.x/src/core.js
	 */
var Jt=Jt||function(t,e){var r={},n=r.lib={},i=n.Base=function(){function t(){}return{extend:function(e){t.prototype=this;var r=new t;return e&&r.mixIn(e),r.hasOwnProperty("init")||(r.init=function(){r.$super.init.apply(this,arguments)}),r.init.prototype=r,r.$super=this,r},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),o=n.WordArray=i.extend({init:function(t,r){t=this.words=t||[],r!=e?this.sigBytes=r:this.sigBytes=4*t.length},toString:function(t){return(t||a).stringify(this)},concat:function(t){var e=this.words,r=t.words,n=this.sigBytes,i=t.sigBytes;if(this.clamp(),n%4)for(var o=0;o<i;o++){var s=r[o>>>2]>>>24-o%4*8&255;e[n+o>>>2]|=s<<24-(n+o)%4*8}else for(var o=0;o<i;o+=4)e[n+o>>>2]=r[o>>>2];return this.sigBytes+=i,this},clamp:function(){var e=this.words,r=this.sigBytes;e[r>>>2]&=4294967295<<32-r%4*8,e.length=t.ceil(r/4)},clone:function(){var t=i.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var r=[],n=0;n<e;n+=4)r.push(4294967296*t.random()|0);return new o.init(r,e)}}),s=r.enc={},a=s.Hex={stringify:function(t){for(var e=t.words,r=t.sigBytes,n=[],i=0;i<r;i++){var o=e[i>>>2]>>>24-i%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r[n>>>3]|=parseInt(t.substr(n,2),16)<<24-n%8*4;return new o.init(r,e/2)}},h=s.Latin1={stringify:function(t){for(var e=t.words,r=t.sigBytes,n=[],i=0;i<r;i++){var o=e[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(o))}return n.join("")},parse:function(t){for(var e=t.length,r=[],n=0;n<e;n++)r[n>>>2]|=(255&t.charCodeAt(n))<<24-n%4*8;return new o.init(r,e)}},f=s.Utf8={stringify:function(t){try{return decodeURIComponent(escape(h.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return h.parse(unescape(encodeURIComponent(t)))}},u=n.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=f.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var r=this._data,n=r.words,i=r.sigBytes,s=this.blockSize,a=4*s,h=i/a;h=e?t.ceil(h):t.max((0|h)-this._minBufferSize,0);var f=h*s,u=t.min(4*f,i);if(f){for(var c=0;c<f;c+=s)this._doProcessBlock(n,c);var p=n.splice(0,f);r.sigBytes-=u}return new o.init(p,u)},clone:function(){var t=i.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),c=(n.Hasher=u.extend({cfg:i.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){t&&this._append(t);var e=this._doFinalize();return e},blockSize:16,_createHelper:function(t){return function(e,r){return new t.init(r).finalize(e)}},_createHmacHelper:function(t){return function(e,r){return new c.HMAC.init(t,r).finalize(e)}}}),r.algo={});return r}(Math);!function(t){var e=Jt,r=e.lib,n=r.WordArray,i=r.Hasher,o=e.algo,s=[],a=[];!function(){function e(e){for(var r=t.sqrt(e),n=2;n<=r;n++)if(!(e%n))return!1;return!0}function r(t){return 4294967296*(t-(0|t))|0}for(var n=2,i=0;i<64;)e(n)&&(i<8&&(s[i]=r(t.pow(n,.5))),a[i]=r(t.pow(n,1/3)),i++),n++}();var h=[],f=o.SHA256=i.extend({_doReset:function(){this._hash=new n.init(s.slice(0))},_doProcessBlock:function(t,e){for(var r=this._hash.words,n=r[0],i=r[1],o=r[2],s=r[3],f=r[4],u=r[5],c=r[6],p=r[7],l=0;l<64;l++){if(l<16)h[l]=0|t[e+l];else{var g=h[l-15],d=(g<<25|g>>>7)^(g<<14|g>>>18)^g>>>3,y=h[l-2],v=(y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10;h[l]=d+h[l-7]+v+h[l-16]}var S=f&u^~f&c,A=n&i^n&o^i&o,m=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),E=(f<<26|f>>>6)^(f<<21|f>>>11)^(f<<7|f>>>25),w=p+E+S+a[l]+h[l],P=m+A;p=c,c=u,u=f,f=s+w|0,s=o,o=i,i=n,n=w+P|0}r[0]=r[0]+n|0,r[1]=r[1]+i|0,r[2]=r[2]+o|0,r[3]=r[3]+s|0,r[4]=r[4]+f|0,r[5]=r[5]+u|0,r[6]=r[6]+c|0,r[7]=r[7]+p|0},_doFinalize:function(){var e=this._data,r=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;return r[i>>>5]|=128<<24-i%32,r[(i+64>>>9<<4)+14]=t.floor(n/4294967296),r[(i+64>>>9<<4)+15]=n,e.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=i._createHelper(f),e.HmacSHA256=i._createHmacHelper(f)}(Math);/*! keyutil-1.0.14.js (c) 2013-2016 Kenji Urushima | kjur.github.com/jsrsasign/license
	 */
/**
	 * @fileOverview
	 * @name keyutil-1.0.js
	 * @author Kenji Urushima kenji.urushima@gmail.com
	 * @version keyutil 1.0.14 (2016-Oct-08)
	 * @since jsrsasign 4.1.4
	 * @license <a href="http://kjur.github.io/jsrsasign/license/">MIT License</a>
	 */
var Wt=function(){var t=function(t,e,r){return i(Jt.AES,t,e,r)},e=function(t,e,r){return i(Jt.TripleDES,t,e,r)},n=function(t,e,r){return i(Jt.DES,t,e,r)},i=function(t,e,r,n){var i=Jt.enc.Hex.parse(e),o=Jt.enc.Hex.parse(r),s=Jt.enc.Hex.parse(n),a={};a.key=o,a.iv=s,a.ciphertext=i;var h=t.decrypt(a,o,{iv:s});return Jt.enc.Hex.stringify(h)},o=function(t,e,r){return h(Jt.AES,t,e,r)},s=function(t,e,r){return h(Jt.TripleDES,t,e,r)},a=function(t,e,r){return h(Jt.DES,t,e,r)},h=function(t,e,r,n){var i=Jt.enc.Hex.parse(e),o=Jt.enc.Hex.parse(r),s=Jt.enc.Hex.parse(n),a=t.encrypt(i,o,{iv:s}),h=Jt.enc.Hex.parse(a.toString()),f=Jt.enc.Base64.stringify(h);return f},f={"AES-256-CBC":{proc:t,eproc:o,keylen:32,ivlen:16},"AES-192-CBC":{proc:t,eproc:o,keylen:24,ivlen:16},"AES-128-CBC":{proc:t,eproc:o,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:e,eproc:s,keylen:24,ivlen:8},"DES-CBC":{proc:n,eproc:a,keylen:8,ivlen:8}},u=function(t){return f[t].proc},c=function(t){var e=Jt.lib.WordArray.random(t),r=Jt.enc.Hex.stringify(e);return r},p=function(t){var e={},r=t.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));r&&(e.cipher=r[1],e.ivsalt=r[2]);var n=t.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));n&&(e.type=n[1]);var i=-1,o=0;t.indexOf("\r\n\r\n")!=-1&&(i=t.indexOf("\r\n\r\n"),o=2),t.indexOf("\n\n")!=-1&&(i=t.indexOf("\n\n"),o=1);var s=t.indexOf("-----END");if(i!=-1&&s!=-1){var a=t.substring(i+2*o,s-o);a=a.replace(/\s+/g,""),e.data=a}return e},l=function(t,e,r){for(var n=r.substring(0,16),i=Jt.enc.Hex.parse(n),o=Jt.enc.Utf8.parse(e),s=f[t].keylen+f[t].ivlen,a="",h=null;;){var u=Jt.algo.MD5.create();if(null!=h&&u.update(h),u.update(o),u.update(i),h=u.finalize(),a+=Jt.enc.Hex.stringify(h),a.length>=2*s)break}var c={};return c.keyhex=a.substr(0,2*f[t].keylen),c.ivhex=a.substr(2*f[t].keylen,2*f[t].ivlen),c},g=function(t,e,r,n){var i=Jt.enc.Base64.parse(t),o=Jt.enc.Hex.stringify(i),s=f[e].proc,a=s(o,r,n);return a},d=function(t,e,r,n){var i=f[e].eproc,o=i(t,r,n);return o};return{version:"1.0.0",getHexFromPEM:function(t,e){var r=t;if(r.indexOf("-----BEGIN ")==-1)throw"can't find PEM header: "+e;"string"==typeof e&&""!=e?(r=r.replace("-----BEGIN "+e+"-----",""),r=r.replace("-----END "+e+"-----","")):(r=r.replace(/-----BEGIN [^-]+-----/,""),r=r.replace(/-----END [^-]+-----/,""));var n=r.replace(/\s+/g,""),i=J(n);return i},getDecryptedKeyHexByKeyIV:function(t,e,r,n){var i=u(e);return i(t,r,n)},parsePKCS5PEM:function(t){return p(t)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(t,e,r){return l(t,e,r)},decryptKeyB64:function(t,e,r,n){return g(t,e,r,n)},getDecryptedKeyHex:function(t,e){var r=p(t),n=(r.type,r.cipher),i=r.ivsalt,o=r.data,s=l(n,e,i),a=s.keyhex,h=g(o,n,a,i);return h},getRSAKeyFromEncryptedPKCS5PEM:function(t,e){var r=this.getDecryptedKeyHex(t,e),n=new ut;return n.readPrivateKeyFromASN1HexString(r),n},getEncryptedPKCS5PEMFromPrvKeyHex:function(t,e,r,n,i){var o="";if("undefined"!=typeof n&&null!=n||(n="AES-256-CBC"),"undefined"==typeof f[n])throw"KEYUTIL unsupported algorithm: "+n;if("undefined"==typeof i||null==i){var s=f[n].ivlen,a=c(s);i=a.toUpperCase()}var h=l(n,r,i),u=h.keyhex,p=d(e,n,u,i),g=p.replace(/(.{64})/g,"$1\r\n"),o="-----BEGIN "+t+" PRIVATE KEY-----\r\n";return o+="Proc-Type: 4,ENCRYPTED\r\n",o+="DEK-Info: "+n+","+i+"\r\n",o+="\r\n",o+=g,o+="\r\n-----END "+t+" PRIVATE KEY-----\r\n"},getEncryptedPKCS5PEMFromRSAKey:function(t,e,r,n){var i=new Ut.asn1.DERInteger({int:0}),o=new Ut.asn1.DERInteger({bigint:t.n}),s=new Ut.asn1.DERInteger({int:t.e}),a=new Ut.asn1.DERInteger({bigint:t.d}),h=new Ut.asn1.DERInteger({bigint:t.p}),f=new Ut.asn1.DERInteger({bigint:t.q}),u=new Ut.asn1.DERInteger({bigint:t.dmp1}),c=new Ut.asn1.DERInteger({bigint:t.dmq1}),p=new Ut.asn1.DERInteger({bigint:t.coeff}),l=new Ut.asn1.DERSequence({array:[i,o,s,a,h,f,u,c,p]}),g=l.getEncodedHex();return this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",g,e,r,n)},newEncryptedPKCS5PEM:function(t,e,r,n){"undefined"!=typeof e&&null!=e||(e=1024),"undefined"!=typeof r&&null!=r||(r="10001");var i=new ut;i.generate(e,r);var o=null;return o="undefined"==typeof n||null==n?this.getEncryptedPKCS5PEMFromRSAKey(i,t):this.getEncryptedPKCS5PEMFromRSAKey(i,t,n)},getRSAKeyFromPlainPKCS8PEM:function(t){if(t.match(/ENCRYPTED/))throw"pem shall be not ENCRYPTED";var e=this.getHexFromPEM(t,"PRIVATE KEY"),r=this.getRSAKeyFromPlainPKCS8Hex(e);return r},getRSAKeyFromPlainPKCS8Hex:function(t){var e=ASN1HEX.getPosArrayOfChildren_AtObj(t,0);if(3!=e.length)throw"outer DERSequence shall have 3 elements: "+e.length;var r=ASN1HEX.getHexOfTLV_AtObj(t,e[1]);if("300d06092a864886f70d0101010500"!=r)throw"PKCS8 AlgorithmIdentifier is not rsaEnc: "+r;var r=ASN1HEX.getHexOfTLV_AtObj(t,e[1]),n=ASN1HEX.getHexOfTLV_AtObj(t,e[2]),i=ASN1HEX.getHexOfV_AtObj(n,0),o=new ut;return o.readPrivateKeyFromASN1HexString(i),o},parseHexOfEncryptedPKCS8:function(t){var e={},r=ASN1HEX.getPosArrayOfChildren_AtObj(t,0);if(2!=r.length)throw"malformed format: SEQUENCE(0).items != 2: "+r.length;e.ciphertext=ASN1HEX.getHexOfV_AtObj(t,r[1]);var n=ASN1HEX.getPosArrayOfChildren_AtObj(t,r[0]);if(2!=n.length)throw"malformed format: SEQUENCE(0.0).items != 2: "+n.length;if("2a864886f70d01050d"!=ASN1HEX.getHexOfV_AtObj(t,n[0]))throw"this only supports pkcs5PBES2";var i=ASN1HEX.getPosArrayOfChildren_AtObj(t,n[1]);if(2!=n.length)throw"malformed format: SEQUENCE(0.0.1).items != 2: "+i.length;var o=ASN1HEX.getPosArrayOfChildren_AtObj(t,i[1]);if(2!=o.length)throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+o.length;if("2a864886f70d0307"!=ASN1HEX.getHexOfV_AtObj(t,o[0]))throw"this only supports TripleDES";e.encryptionSchemeAlg="TripleDES",e.encryptionSchemeIV=ASN1HEX.getHexOfV_AtObj(t,o[1]);var s=ASN1HEX.getPosArrayOfChildren_AtObj(t,i[0]);if(2!=s.length)throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+s.length;if("2a864886f70d01050c"!=ASN1HEX.getHexOfV_AtObj(t,s[0]))throw"this only supports pkcs5PBKDF2";var a=ASN1HEX.getPosArrayOfChildren_AtObj(t,s[1]);if(a.length<2)throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+a.length;e.pbkdf2Salt=ASN1HEX.getHexOfV_AtObj(t,a[0]);var h=ASN1HEX.getHexOfV_AtObj(t,a[1]);try{e.pbkdf2Iter=parseInt(h,16)}catch(t){throw"malformed format pbkdf2Iter: "+h}return e},getPBKDF2KeyHexFromParam:function(t,e){var r=Jt.enc.Hex.parse(t.pbkdf2Salt),n=t.pbkdf2Iter,i=Jt.PBKDF2(e,r,{keySize:6,iterations:n}),o=Jt.enc.Hex.stringify(i);return o},getPlainPKCS8HexFromEncryptedPKCS8PEM:function(t,e){var r=this.getHexFromPEM(t,"ENCRYPTED PRIVATE KEY"),n=this.parseHexOfEncryptedPKCS8(r),i=Wt.getPBKDF2KeyHexFromParam(n,e),o={};o.ciphertext=Jt.enc.Hex.parse(n.ciphertext);var s=Jt.enc.Hex.parse(i),a=Jt.enc.Hex.parse(n.encryptionSchemeIV),h=Jt.TripleDES.decrypt(o,s,{iv:a}),f=Jt.enc.Hex.stringify(h);return f},getRSAKeyFromEncryptedPKCS8PEM:function(t,e){var r=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(t,e),n=this.getRSAKeyFromPlainPKCS8Hex(r);return n},getKeyFromEncryptedPKCS8PEM:function(t,e){var r=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(t,e),n=this.getKeyFromPlainPrivatePKCS8Hex(r);return n},parsePlainPrivatePKCS8Hex:function(t){var e={};if(e.algparam=null,"30"!=t.substr(0,2))throw"malformed plain PKCS8 private key(code:001)";var r=ASN1HEX.getPosArrayOfChildren_AtObj(t,0);if(3!=r.length)throw"malformed plain PKCS8 private key(code:002)";if("30"!=t.substr(r[1],2))throw"malformed PKCS8 private key(code:003)";var n=ASN1HEX.getPosArrayOfChildren_AtObj(t,r[1]);if(2!=n.length)throw"malformed PKCS8 private key(code:004)";if("06"!=t.substr(n[0],2))throw"malformed PKCS8 private key(code:005)";if(e.algoid=ASN1HEX.getHexOfV_AtObj(t,n[0]),"06"==t.substr(n[1],2)&&(e.algparam=ASN1HEX.getHexOfV_AtObj(t,n[1])),"04"!=t.substr(r[2],2))throw"malformed PKCS8 private key(code:006)";return e.keyidx=ASN1HEX.getStartPosOfV_AtObj(t,r[2]),e},getKeyFromPlainPrivatePKCS8PEM:function(t){var e=this.getHexFromPEM(t,"PRIVATE KEY"),r=this.getKeyFromPlainPrivatePKCS8Hex(e);return r},getKeyFromPlainPrivatePKCS8Hex:function(t){var e=this.parsePlainPrivatePKCS8Hex(t);if("2a864886f70d010101"==e.algoid){this.parsePrivateRawRSAKeyHexAtObj(t,e);var n=e.key,i=new ut;return i.setPrivateEx(n.n,n.e,n.d,n.p,n.q,n.dp,n.dq,n.co),i}if("2a8648ce3d0201"==e.algoid){if(this.parsePrivateRawECKeyHexAtObj(t,e),void 0===Ut.crypto.OID.oidhex2name[e.algparam])throw"KJUR.crypto.OID.oidhex2name undefined: "+e.algparam;var o=Ut.crypto.OID.oidhex2name[e.algparam],i=new Ut.crypto.ECDSA({curve:o});return i.setPublicKeyHex(e.pubkey),i.setPrivateKeyHex(e.key),i.isPublic=!1,i}if("2a8648ce380401"==e.algoid){var s=ASN1HEX.getVbyList(t,0,[1,1,0],"02"),a=ASN1HEX.getVbyList(t,0,[1,1,1],"02"),h=ASN1HEX.getVbyList(t,0,[1,1,2],"02"),f=ASN1HEX.getVbyList(t,0,[2,0],"02"),u=new r(s,16),c=new r(a,16),p=new r(h,16),l=new r(f,16),i=new Ut.crypto.DSA;return i.setPrivate(u,c,p,null,l),i}throw"unsupported private key algorithm"},getRSAKeyFromPublicPKCS8PEM:function(t){var e=this.getHexFromPEM(t,"PUBLIC KEY"),r=this.getRSAKeyFromPublicPKCS8Hex(e);return r},getKeyFromPublicPKCS8PEM:function(t){var e=this.getHexFromPEM(t,"PUBLIC KEY"),r=this.getKeyFromPublicPKCS8Hex(e);return r},getKeyFromPublicPKCS8Hex:function(t){var e=this.parsePublicPKCS8Hex(t);if("2a864886f70d010101"==e.algoid){var n=this.parsePublicRawRSAKeyHex(e.key),i=new ut;return i.setPublic(n.n,n.e),i}if("2a8648ce3d0201"==e.algoid){if(void 0===Ut.crypto.OID.oidhex2name[e.algparam])throw"KJUR.crypto.OID.oidhex2name undefined: "+e.algparam;var o=Ut.crypto.OID.oidhex2name[e.algparam],i=new Ut.crypto.ECDSA({curve:o,pub:e.key});return i}if("2a8648ce380401"==e.algoid){var s=e.algparam,a=ASN1HEX.getHexOfV_AtObj(e.key,0),i=new Ut.crypto.DSA;return i.setPublic(new r(s.p,16),new r(s.q,16),new r(s.g,16),new r(a,16)),i}throw"unsupported public key algorithm"},parsePublicRawRSAKeyHex:function(t){var e={};if("30"!=t.substr(0,2))throw"malformed RSA key(code:001)";var r=ASN1HEX.getPosArrayOfChildren_AtObj(t,0);if(2!=r.length)throw"malformed RSA key(code:002)";if("02"!=t.substr(r[0],2))throw"malformed RSA key(code:003)";if(e.n=ASN1HEX.getHexOfV_AtObj(t,r[0]),"02"!=t.substr(r[1],2))throw"malformed RSA key(code:004)";return e.e=ASN1HEX.getHexOfV_AtObj(t,r[1]),e},parsePrivateRawRSAKeyHexAtObj:function(t,e){var r=e.keyidx;if("30"!=t.substr(r,2))throw"malformed RSA private key(code:001)";var n=ASN1HEX.getPosArrayOfChildren_AtObj(t,r);if(9!=n.length)throw"malformed RSA private key(code:002)";e.key={},e.key.n=ASN1HEX.getHexOfV_AtObj(t,n[1]),e.key.e=ASN1HEX.getHexOfV_AtObj(t,n[2]),e.key.d=ASN1HEX.getHexOfV_AtObj(t,n[3]),e.key.p=ASN1HEX.getHexOfV_AtObj(t,n[4]),e.key.q=ASN1HEX.getHexOfV_AtObj(t,n[5]),e.key.dp=ASN1HEX.getHexOfV_AtObj(t,n[6]),e.key.dq=ASN1HEX.getHexOfV_AtObj(t,n[7]),e.key.co=ASN1HEX.getHexOfV_AtObj(t,n[8])},parsePrivateRawECKeyHexAtObj:function(t,e){var r=e.keyidx,n=ASN1HEX.getVbyList(t,r,[1],"04"),i=ASN1HEX.getVbyList(t,r,[2,0],"03").substr(2);e.key=n,e.pubkey=i},parsePublicPKCS8Hex:function(t){var e={};e.algparam=null;var r=ASN1HEX.getPosArrayOfChildren_AtObj(t,0);if(2!=r.length)throw"outer DERSequence shall have 2 elements: "+r.length;var n=r[0];if("30"!=t.substr(n,2))throw"malformed PKCS8 public key(code:001)";var i=ASN1HEX.getPosArrayOfChildren_AtObj(t,n);if(2!=i.length)throw"malformed PKCS8 public key(code:002)";if("06"!=t.substr(i[0],2))throw"malformed PKCS8 public key(code:003)";if(e.algoid=ASN1HEX.getHexOfV_AtObj(t,i[0]),"06"==t.substr(i[1],2)?e.algparam=ASN1HEX.getHexOfV_AtObj(t,i[1]):"30"==t.substr(i[1],2)&&(e.algparam={},e.algparam.p=ASN1HEX.getVbyList(t,i[1],[0],"02"),e.algparam.q=ASN1HEX.getVbyList(t,i[1],[1],"02"),e.algparam.g=ASN1HEX.getVbyList(t,i[1],[2],"02")),"03"!=t.substr(r[1],2))throw"malformed PKCS8 public key(code:004)";return e.key=ASN1HEX.getHexOfV_AtObj(t,r[1]).substr(2),e},getRSAKeyFromPublicPKCS8Hex:function(t){var e=ASN1HEX.getPosArrayOfChildren_AtObj(t,0);if(2!=e.length)throw"outer DERSequence shall have 2 elements: "+e.length;var r=ASN1HEX.getHexOfTLV_AtObj(t,e[0]);if("300d06092a864886f70d0101010500"!=r)throw"PKCS8 AlgorithmId is not rsaEncryption";if("03"!=t.substr(e[1],2))throw"PKCS8 Public Key is not BITSTRING encapslated.";var n=ASN1HEX.getStartPosOfV_AtObj(t,e[1])+2;if("30"!=t.substr(n,2))throw"PKCS8 Public Key is not SEQUENCE.";var i=ASN1HEX.getPosArrayOfChildren_AtObj(t,n);if(2!=i.length)throw"inner DERSequence shall have 2 elements: "+i.length;if("02"!=t.substr(i[0],2))throw"N is not ASN.1 INTEGER";if("02"!=t.substr(i[1],2))throw"E is not ASN.1 INTEGER";var o=ASN1HEX.getHexOfV_AtObj(t,i[0]),s=ASN1HEX.getHexOfV_AtObj(t,i[1]),a=new ut;return a.setPublic(o,s),a}}}();Wt.getKey=function(t,e,n){if("undefined"!=typeof ut&&t instanceof ut)return t;if("undefined"!=typeof Ut.crypto.ECDSA&&t instanceof Ut.crypto.ECDSA)return t;if("undefined"!=typeof Ut.crypto.DSA&&t instanceof Ut.crypto.DSA)return t;if(void 0!==t.curve&&void 0!==t.xy&&void 0===t.d)return new Ut.crypto.ECDSA({pub:t.xy,curve:t.curve});if(void 0!==t.curve&&void 0!==t.d)return new Ut.crypto.ECDSA({prv:t.d,curve:t.curve});if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0===t.d){var i=new ut;return i.setPublic(t.n,t.e),i}if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0!==t.p&&void 0!==t.q&&void 0!==t.dp&&void 0!==t.dq&&void 0!==t.co&&void 0===t.qi){var i=new ut;return i.setPrivateEx(t.n,t.e,t.d,t.p,t.q,t.dp,t.dq,t.co),i}if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0===t.p){var i=new ut;return i.setPrivate(t.n,t.e,t.d),i}if(void 0!==t.p&&void 0!==t.q&&void 0!==t.g&&void 0!==t.y&&void 0===t.x){var i=new Ut.crypto.DSA;return i.setPublic(t.p,t.q,t.g,t.y),i}if(void 0!==t.p&&void 0!==t.q&&void 0!==t.g&&void 0!==t.y&&void 0!==t.x){var i=new Ut.crypto.DSA;return i.setPrivate(t.p,t.q,t.g,t.y,t.x),i}if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0===t.d){var i=new ut;return i.setPublic(Q(t.n),Q(t.e)),i}if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0!==t.p&&void 0!==t.q&&void 0!==t.dp&&void 0!==t.dq&&void 0!==t.qi){var i=new ut;return i.setPrivateEx(Q(t.n),Q(t.e),Q(t.d),Q(t.p),Q(t.q),Q(t.dp),Q(t.dq),Q(t.qi)),i}if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d){var i=new ut;return i.setPrivate(Q(t.n),Q(t.e),Q(t.d)),i}if("EC"===t.kty&&void 0!==t.crv&&void 0!==t.x&&void 0!==t.y&&void 0===t.d){var o=new Ut.crypto.ECDSA({curve:t.crv}),s=o.ecparams.keylen/4,a=("0000000000"+Q(t.x)).slice(-s),h=("0000000000"+Q(t.y)).slice(-s),f="04"+a+h;return o.setPublicKeyHex(f),o}if("EC"===t.kty&&void 0!==t.crv&&void 0!==t.x&&void 0!==t.y&&void 0!==t.d){var o=new Ut.crypto.ECDSA({curve:t.crv}),s=o.ecparams.keylen/4,a=("0000000000"+Q(t.x)).slice(-s),h=("0000000000"+Q(t.y)).slice(-s),f="04"+a+h,u=("0000000000"+Q(t.d)).slice(-s);return o.setPublicKeyHex(f),o.setPrivateKeyHex(u),o}if(t.indexOf("-END CERTIFICATE-",0)!=-1||t.indexOf("-END X509 CERTIFICATE-",0)!=-1||t.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1)return X509.getPublicKeyFromCertPEM(t);if("pkcs8pub"===n)return Wt.getKeyFromPublicPKCS8Hex(t);if(t.indexOf("-END PUBLIC KEY-")!=-1)return Wt.getKeyFromPublicPKCS8PEM(t);if("pkcs5prv"===n){var i=new ut;return i.readPrivateKeyFromASN1HexString(t),i}if("pkcs5prv"===n){var i=new ut;return i.readPrivateKeyFromASN1HexString(t),i}if(t.indexOf("-END RSA PRIVATE KEY-")!=-1&&t.indexOf("4,ENCRYPTED")==-1){var c=Wt.getHexFromPEM(t,"RSA PRIVATE KEY");return Wt.getKey(c,null,"pkcs5prv")}if(t.indexOf("-END DSA PRIVATE KEY-")!=-1&&t.indexOf("4,ENCRYPTED")==-1){var p=this.getHexFromPEM(t,"DSA PRIVATE KEY"),l=ASN1HEX.getVbyList(p,0,[1],"02"),g=ASN1HEX.getVbyList(p,0,[2],"02"),d=ASN1HEX.getVbyList(p,0,[3],"02"),y=ASN1HEX.getVbyList(p,0,[4],"02"),v=ASN1HEX.getVbyList(p,0,[5],"02"),i=new Ut.crypto.DSA;return i.setPrivate(new r(l,16),new r(g,16),new r(d,16),new r(y,16),new r(v,16)),i}if(t.indexOf("-END PRIVATE KEY-")!=-1)return Wt.getKeyFromPlainPrivatePKCS8PEM(t);if(t.indexOf("-END RSA PRIVATE KEY-")!=-1&&t.indexOf("4,ENCRYPTED")!=-1)return Wt.getRSAKeyFromEncryptedPKCS5PEM(t,e);if(t.indexOf("-END EC PRIVATE KEY-")!=-1&&t.indexOf("4,ENCRYPTED")!=-1){var p=Wt.getDecryptedKeyHex(t,e),i=ASN1HEX.getVbyList(p,0,[1],"04"),S=ASN1HEX.getVbyList(p,0,[2,0],"06"),A=ASN1HEX.getVbyList(p,0,[3,0],"03").substr(2),m="";if(void 0===Ut.crypto.OID.oidhex2name[S])throw"undefined OID(hex) in KJUR.crypto.OID: "+S;m=Ut.crypto.OID.oidhex2name[S];var o=new Ut.crypto.ECDSA({name:m});return o.setPublicKeyHex(A),o.setPrivateKeyHex(i),o.isPublic=!1,o}if(t.indexOf("-END DSA PRIVATE KEY-")!=-1&&t.indexOf("4,ENCRYPTED")!=-1){var p=Wt.getDecryptedKeyHex(t,e),l=ASN1HEX.getVbyList(p,0,[1],"02"),g=ASN1HEX.getVbyList(p,0,[2],"02"),d=ASN1HEX.getVbyList(p,0,[3],"02"),y=ASN1HEX.getVbyList(p,0,[4],"02"),v=ASN1HEX.getVbyList(p,0,[5],"02"),i=new Ut.crypto.DSA;return i.setPrivate(new r(l,16),new r(g,16),new r(d,16),new r(y,16),new r(v,16)),i}if(t.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1)return Wt.getKeyFromEncryptedPKCS8PEM(t,e);throw"not supported argument"},Wt.generateKeypair=function(t,e){if("RSA"==t){var r=e,n=new ut;n.generate(r,"10001"),n.isPrivate=!0,n.isPublic=!0;var i=new ut,o=n.n.toString(16),s=n.e.toString(16);i.setPublic(o,s),i.isPrivate=!1,i.isPublic=!0;var a={};return a.prvKeyObj=n,a.pubKeyObj=i,a}if("EC"==t){var h=e,f=new Ut.crypto.ECDSA({curve:h}),u=f.generateKeyPairHex(),n=new Ut.crypto.ECDSA({curve:h});n.setPublicKeyHex(u.ecpubhex),n.setPrivateKeyHex(u.ecprvhex),n.isPrivate=!0,n.isPublic=!1;var i=new Ut.crypto.ECDSA({curve:h});i.setPublicKeyHex(u.ecpubhex),i.isPrivate=!1,i.isPublic=!0;var a={};return a.prvKeyObj=n,a.pubKeyObj=i,a}throw"unknown algorithm: "+t},Wt.getPEM=function(t,e,r,n,i){function o(t){var e=Ut.asn1.ASN1Util.newObject({seq:[{int:0},{int:{bigint:t.n}},{int:t.e},{int:{bigint:t.d}},{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.dmp1}},{int:{bigint:t.dmq1}},{int:{bigint:t.coeff}}]});return e}function s(t){var e=Ut.asn1.ASN1Util.newObject({seq:[{int:1},{octstr:{hex:t.prvKeyHex}},{tag:["a0",!0,{oid:{name:t.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+t.pubKeyHex}}]}]});return e}function a(t){var e=Ut.asn1.ASN1Util.newObject({seq:[{int:0},{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}},{int:{bigint:t.y}},{int:{bigint:t.x}}]});return e}var h=Ut.asn1,f=Ut.crypto;if(("undefined"!=typeof ut&&t instanceof ut||"undefined"!=typeof f.DSA&&t instanceof f.DSA||"undefined"!=typeof f.ECDSA&&t instanceof f.ECDSA)&&1==t.isPublic&&(void 0===e||"PKCS8PUB"==e)){var u=new Ut.asn1.x509.SubjectPublicKeyInfo(t),c=u.getEncodedHex();return h.ASN1Util.getPEMStringFromHex(c,"PUBLIC KEY")}if("PKCS1PRV"==e&&"undefined"!=typeof ut&&t instanceof ut&&(void 0===r||null==r)&&1==t.isPrivate){var u=o(t),c=u.getEncodedHex();return h.ASN1Util.getPEMStringFromHex(c,"RSA PRIVATE KEY")}if("PKCS1PRV"==e&&"undefined"!=typeof ut&&t instanceof Ut.crypto.ECDSA&&(void 0===r||null==r)&&1==t.isPrivate){var p=new Ut.asn1.DERObjectIdentifier({name:t.curveName}),l=p.getEncodedHex(),g=s(t),d=g.getEncodedHex(),y="";return y+=h.ASN1Util.getPEMStringFromHex(l,"EC PARAMETERS"),y+=h.ASN1Util.getPEMStringFromHex(d,"EC PRIVATE KEY")}if("PKCS1PRV"==e&&"undefined"!=typeof Ut.crypto.DSA&&t instanceof Ut.crypto.DSA&&(void 0===r||null==r)&&1==t.isPrivate){var u=a(t),c=u.getEncodedHex();return h.ASN1Util.getPEMStringFromHex(c,"DSA PRIVATE KEY")}if("PKCS5PRV"==e&&"undefined"!=typeof ut&&t instanceof ut&&void 0!==r&&null!=r&&1==t.isPrivate){var u=o(t),c=u.getEncodedHex();return void 0===n&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",c,r,n)}if("PKCS5PRV"==e&&"undefined"!=typeof Ut.crypto.ECDSA&&t instanceof Ut.crypto.ECDSA&&void 0!==r&&null!=r&&1==t.isPrivate){var u=s(t),c=u.getEncodedHex();return void 0===n&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",c,r,n)}if("PKCS5PRV"==e&&"undefined"!=typeof Ut.crypto.DSA&&t instanceof Ut.crypto.DSA&&void 0!==r&&null!=r&&1==t.isPrivate){var u=a(t),c=u.getEncodedHex();return void 0===n&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",c,r,n)}var v=function(t,e){var r=S(t,e),n=new Ut.asn1.ASN1Util.newObject({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:r.pbkdf2Salt}},{int:r.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:r.encryptionSchemeIV}}]}]}]},{octstr:{hex:r.ciphertext}}]});return n.getEncodedHex()},S=function(t,e){var r=100,n=Jt.lib.WordArray.random(8),i="DES-EDE3-CBC",o=Jt.lib.WordArray.random(8),s=Jt.PBKDF2(e,n,{keySize:6,iterations:r}),a=Jt.enc.Hex.parse(t),h=Jt.TripleDES.encrypt(a,s,{iv:o})+"",f={};return f.ciphertext=h,f.pbkdf2Salt=Jt.enc.Hex.stringify(n),f.pbkdf2Iter=r,f.encryptionSchemeAlg=i,f.encryptionSchemeIV=Jt.enc.Hex.stringify(o),f};if("PKCS8PRV"==e&&"undefined"!=typeof ut&&t instanceof ut&&1==t.isPrivate){var A=o(t),m=A.getEncodedHex(),u=Ut.asn1.ASN1Util.newObject({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:m}}]}),c=u.getEncodedHex();if(void 0===r||null==r)return h.ASN1Util.getPEMStringFromHex(c,"PRIVATE KEY");var d=v(c,r);return h.ASN1Util.getPEMStringFromHex(d,"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==e&&"undefined"!=typeof Ut.crypto.ECDSA&&t instanceof Ut.crypto.ECDSA&&1==t.isPrivate){var A=new Ut.asn1.ASN1Util.newObject({seq:[{int:1},{octstr:{hex:t.prvKeyHex}},{tag:["a1",!0,{bitstr:{hex:"00"+t.pubKeyHex}}]}]}),m=A.getEncodedHex(),u=Ut.asn1.ASN1Util.newObject({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:t.curveName}}]},{octstr:{hex:m}}]}),c=u.getEncodedHex();if(void 0===r||null==r)return h.ASN1Util.getPEMStringFromHex(c,"PRIVATE KEY");var d=v(c,r);return h.ASN1Util.getPEMStringFromHex(d,"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==e&&"undefined"!=typeof Ut.crypto.DSA&&t instanceof Ut.crypto.DSA&&1==t.isPrivate){var A=new Ut.asn1.DERInteger({bigint:t.x}),m=A.getEncodedHex(),u=Ut.asn1.ASN1Util.newObject({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}}]}]},{octstr:{hex:m}}]}),c=u.getEncodedHex();if(void 0===r||null==r)return h.ASN1Util.getPEMStringFromHex(c,"PRIVATE KEY");var d=v(c,r);return h.ASN1Util.getPEMStringFromHex(d,"ENCRYPTED PRIVATE KEY")}throw"unsupported object nor format"},Wt.getKeyFromCSRPEM=function(t){var e=Wt.getHexFromPEM(t,"CERTIFICATE REQUEST"),r=Wt.getKeyFromCSRHex(e);return r},Wt.getKeyFromCSRHex=function(t){var e=Wt.parseCSRHex(t),r=Wt.getKey(e.p8pubkeyhex,null,"pkcs8pub");return r},Wt.parseCSRHex=function(t){var e={},r=t;if("30"!=r.substr(0,2))throw"malformed CSR(code:001)";var n=ASN1HEX.getPosArrayOfChildren_AtObj(r,0);if(n.length<1)throw"malformed CSR(code:002)";if("30"!=r.substr(n[0],2))throw"malformed CSR(code:003)";var i=ASN1HEX.getPosArrayOfChildren_AtObj(r,n[0]);if(i.length<3)throw"malformed CSR(code:004)";return e.p8pubkeyhex=ASN1HEX.getHexOfTLV_AtObj(r,i[2]),e},Wt.getJWKFromKey=function(t){var e={};if(t instanceof ut&&t.isPrivate)return e.kty="RSA",e.n=Z(t.n.toString(16)),e.e=Z(t.e.toString(16)),e.d=Z(t.d.toString(16)),e.p=Z(t.p.toString(16)),e.q=Z(t.q.toString(16)),e.dp=Z(t.dmp1.toString(16)),e.dq=Z(t.dmq1.toString(16)),e.qi=Z(t.coeff.toString(16)),e;if(t instanceof ut&&t.isPublic)return e.kty="RSA",e.n=Z(t.n.toString(16)),e.e=Z(t.e.toString(16)),e;if(t instanceof Ut.crypto.ECDSA&&t.isPrivate){var r=t.getShortNISTPCurveName();if("P-256"!==r&&"P-384"!==r)throw"unsupported curve name for JWT: "+r;var n=t.getPublicKeyXYHex();return e.kty="EC",e.crv=r,e.x=Z(n.x),e.y=Z(n.y),e.d=Z(t.prvKeyHex),e}if(t instanceof Ut.crypto.ECDSA&&t.isPublic){var r=t.getShortNISTPCurveName();if("P-256"!==r&&"P-384"!==r)throw"unsupported curve name for JWT: "+r;var n=t.getPublicKeyXYHex();return e.kty="EC",e.crv=r,e.x=Z(n.x),e.y=Z(n.y),e}throw"not supported key object"},/*! crypto-1.1.10.js (c) 2013-2016 Kenji Urushima | kjur.github.com/jsrsasign/license
	 */
/**
	 * @fileOverview
	 * @name crypto-1.1.js
	 * @author Kenji Urushima kenji.urushima@gmail.com
	 * @version 1.1.10 (2016-Oct-29)
	 * @since jsrsasign 2.2
	 * @license <a href="http://kjur.github.io/jsrsasign/license/">MIT License</a>
	 */
"undefined"!=typeof Ut&&Ut||(Ut={}),"undefined"!=typeof Ut.crypto&&Ut.crypto||(Ut.crypto={}),Ut.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:Jt.algo.MD5,sha1:Jt.algo.SHA1,sha224:Jt.algo.SHA224,sha256:Jt.algo.SHA256,sha384:Jt.algo.SHA384,sha512:Jt.algo.SHA512,ripemd160:Jt.algo.RIPEMD160},this.getDigestInfoHex=function(t,e){if("undefined"==typeof this.DIGESTINFOHEAD[e])throw"alg not supported in Util.DIGESTINFOHEAD: "+e;return this.DIGESTINFOHEAD[e]+t},this.getPaddedDigestInfoHex=function(t,e,r){var n=this.getDigestInfoHex(t,e),i=r/4;if(n.length+22>i)throw"key is too short for SigAlg: keylen="+r+","+e;for(var o="0001",s="00"+n,a="",h=i-o.length-s.length,f=0;f<h;f+=2)a+="ff";var u=o+a+s;return u},this.hashString=function(t,e){var r=new Ut.crypto.MessageDigest({alg:e});return r.digestString(t)},this.hashHex=function(t,e){var r=new Ut.crypto.MessageDigest({alg:e});return r.digestHex(t)},this.sha1=function(t){var e=new Ut.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"});return e.digestString(t)},this.sha256=function(t){var e=new Ut.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"});return e.digestString(t)},this.sha256Hex=function(t){var e=new Ut.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"});return e.digestHex(t)},this.sha512=function(t){var e=new Ut.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"});return e.digestString(t)},this.sha512Hex=function(t){var e=new Ut.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"});return e.digestHex(t)},this.md5=function(t){var e=new Ut.crypto.MessageDigest({alg:"md5",prov:"cryptojs"});return e.digestString(t)},this.ripemd160=function(t){var e=new Ut.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"});return e.digestString(t)},this.getCryptoJSMDByName=function(t){}},Ut.crypto.MessageDigest=function(t){this.setAlgAndProvider=function(t,e){if(t=Ut.crypto.MessageDigest.getCanonicalAlgName(t),null!==t&&void 0===e&&(e=Ut.crypto.Util.DEFAULTPROVIDER[t]),":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(t)!=-1&&"cryptojs"==e){try{this.md=Ut.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[t].create()}catch(e){throw"setAlgAndProvider hash alg set fail alg="+t+"/"+e}this.updateString=function(t){this.md.update(t)},this.updateHex=function(t){var e=Jt.enc.Hex.parse(t);this.md.update(e)},this.digest=function(){var t=this.md.finalize();return t.toString(Jt.enc.Hex)},this.digestString=function(t){return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}if(":sha256:".indexOf(t)!=-1&&"sjcl"==e){try{this.md=new sjcl.hash.sha256}catch(e){throw"setAlgAndProvider hash alg set fail alg="+t+"/"+e}this.updateString=function(t){this.md.update(t)},this.updateHex=function(t){var e=sjcl.codec.hex.toBits(t);this.md.update(e)},this.digest=function(){var t=this.md.finalize();return sjcl.codec.hex.fromBits(t)},this.digestString=function(t){return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}},this.updateString=function(t){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==t&&void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov&&(this.provName=Ut.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},Ut.crypto.MessageDigest.getCanonicalAlgName=function(t){return"string"==typeof t&&(t=t.toLowerCase(),t=t.replace(/-/,"")),t},Ut.crypto.MessageDigest.getHashLength=function(t){var e=Ut.crypto.MessageDigest,r=e.getCanonicalAlgName(t);if(void 0===e.HASHLENGTH[r])throw"not supported algorithm: "+t;return e.HASHLENGTH[r]},Ut.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},Ut.crypto.Mac=function(t){this.setAlgAndProvider=function(t,e){if(t=t.toLowerCase(),null==t&&(t="hmacsha1"),t=t.toLowerCase(),"hmac"!=t.substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+t;void 0===e&&(e=Ut.crypto.Util.DEFAULTPROVIDER[t]),this.algProv=t+"/"+e;var r=t.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(r)!=-1&&"cryptojs"==e){try{var n=Ut.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[r];this.mac=Jt.algo.HMAC.create(n,this.pass)}catch(t){throw"setAlgAndProvider hash alg set fail hashAlg="+r+"/"+t}this.updateString=function(t){this.mac.update(t)},this.updateHex=function(t){var e=Jt.enc.Hex.parse(t);this.mac.update(e)},this.doFinal=function(){var t=this.mac.finalize();return t.toString(Jt.enc.Hex)},this.doFinalString=function(t){return this.updateString(t),this.doFinal()},this.doFinalHex=function(t){return this.updateHex(t),this.doFinal()}}},this.updateString=function(t){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(t){if("string"==typeof t){var e=t;return t.length%2!=1&&t.match(/^[0-9A-Fa-f]+$/)||(e=rt(t)),void(this.pass=Jt.enc.Hex.parse(e))}if("object"!=typeof t)throw"KJUR.crypto.Mac unsupported password type: "+t;var e=null;if(void 0!==t.hex){if(t.hex.length%2!=0||!t.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+t.hex;e=t.hex}if(void 0!==t.utf8&&(e=tt(t.utf8)),void 0!==t.rstr&&(e=rt(t.rstr)),void 0!==t.b64&&(e=J(t.b64)),void 0!==t.b64u&&(e=Q(t.b64u)),null==e)throw"KJUR.crypto.Mac unsupported password type: "+t;this.pass=Jt.enc.Hex.parse(e)},void 0!==t&&(void 0!==t.pass&&this.setPassword(t.pass),void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov&&(this.provName=Ut.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},Ut.crypto.Signature=function(t){var e=null;if(this._setAlgNames=function(){var t=this.algName.match(/^(.+)with(.+)$/);t&&(this.mdAlgName=t[1].toLowerCase(),this.pubkeyAlgName=t[2].toLowerCase())},this._zeroPaddingOfSignature=function(t,e){for(var r="",n=e/4-t.length,i=0;i<n;i++)r+="0";return r+t},this.setAlgAndProvider=function(t,e){if(this._setAlgNames(),"cryptojs/jsrsa"!=e)throw"provider not supported: "+e;if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new Ut.crypto.MessageDigest({alg:this.mdAlgName})}catch(t){throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+t}this.init=function(t,e){var r=null;try{r=void 0===e?Wt.getKey(t):Wt.getKey(t,e)}catch(t){throw"init failed:"+t}if(r.isPrivate===!0)this.prvKey=r,this.state="SIGN";else{if(r.isPublic!==!0)throw"init failed.:"+r;this.pubKey=r,this.state="VERIFY"}},this.initSign=function(t){"string"==typeof t.ecprvhex&&"string"==typeof t.eccurvename?(this.ecprvhex=t.ecprvhex,this.eccurvename=t.eccurvename):this.prvKey=t,this.state="SIGN"},this.initVerifyByPublicKey=function(t){"string"==typeof t.ecpubhex&&"string"==typeof t.eccurvename?(this.ecpubhex=t.ecpubhex,this.eccurvename=t.eccurvename):t instanceof Ut.crypto.ECDSA?this.pubKey=t:t instanceof ut&&(this.pubKey=t),this.state="VERIFY"},this.initVerifyByCertificatePEM=function(t){var e=new X509;e.readCertPEM(t),this.pubKey=e.subjectPublicKeyRSA,this.state="VERIFY"},this.updateString=function(t){this.md.updateString(t)},this.updateHex=function(t){this.md.updateHex(t)},this.sign=function(){if(this.sHashHex=this.md.digest(),"undefined"!=typeof this.ecprvhex&&"undefined"!=typeof this.eccurvename){var t=new Ut.crypto.ECDSA({curve:this.eccurvename});this.hSign=t.signHex(this.sHashHex,this.ecprvhex)}else if(this.prvKey instanceof ut&&"rsaandmgf1"==this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof ut&&"rsa"==this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof Ut.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof Ut.crypto.DSA))throw"Signature: unsupported public key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(t){return this.updateString(t),this.sign()},this.signHex=function(t){return this.updateHex(t),this.sign()},this.verify=function(t){if(this.sHashHex=this.md.digest(),"undefined"!=typeof this.ecpubhex&&"undefined"!=typeof this.eccurvename){var e=new Ut.crypto.ECDSA({curve:this.eccurvename});return e.verifyHex(this.sHashHex,t,this.ecpubhex)}if(this.pubKey instanceof ut&&"rsaandmgf1"==this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,t,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof ut&&"rsa"==this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);if(this.pubKey instanceof Ut.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);if(this.pubKey instanceof Ut.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(t,e){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.initVerifyByPublicKey=function(t){throw"initVerifyByPublicKey(rsaPubKeyy) not supported for this alg:prov="+this.algProvName},this.initVerifyByCertificatePEM=function(t){throw"initVerifyByCertificatePEM(certPEM) not supported for this alg:prov="+this.algProvName},this.initSign=function(t){throw"initSign(prvKey) not supported for this alg:prov="+this.algProvName},this.updateString=function(t){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(t){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(t){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(t){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=t,void 0!==t&&(void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov?this.provName=Ut.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=t.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==t.psssaltlen&&(this.pssSaltLen=t.psssaltlen),void 0!==t.prvkeypem)){if(void 0!==t.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{var e=new ut;e.readPrivateKeyFromPEMString(t.prvkeypem),this.initSign(e)}catch(t){throw"fatal error to load pem private key: "+t}}},Ut.crypto.Cipher=function(t){},Ut.crypto.Cipher.encrypt=function(t,e,r){if(e instanceof ut&&e.isPublic){var n=Ut.crypto.Cipher.getAlgByKeyAndName(e,r);if("RSA"===n)return e.encrypt(t);if("RSAOAEP"===n)return e.encryptOAEP(t,"sha1");var i=n.match(/^RSAOAEP(\d+)$/);if(null!==i)return e.encryptOAEP(t,"sha"+i[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+r}throw"Cipher.encrypt: unsupported key or algorithm"},Ut.crypto.Cipher.decrypt=function(t,e,r){if(e instanceof ut&&e.isPrivate){var n=Ut.crypto.Cipher.getAlgByKeyAndName(e,r);if("RSA"===n)return e.decrypt(t);if("RSAOAEP"===n)return e.decryptOAEP(t,"sha1");var i=n.match(/^RSAOAEP(\d+)$/);if(null!==i)return e.decryptOAEP(t,"sha"+i[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+r}throw"Cipher.decrypt: unsupported key or algorithm"},Ut.crypto.Cipher.getAlgByKeyAndName=function(t,e){if(t instanceof ut){if(":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(e)!=-1)return e;if(null===e||void 0===e)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+e}throw"getAlgByKeyAndName: not supported algorithm name: "+e},Ut.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}};/*! rsasign-1.2.7.js (c) 2012 Kenji Urushima | kjur.github.com/jsrsasign/license
	 */
/**
	 * @fileOverview
	 * @name rsasign-1.2.js
	 * @author Kenji Urushima kenji.urushima@gmail.com
	 * @version rsasign 1.2.7
	 * @license <a href="http://kjur.github.io/jsrsasign/license/">MIT License</a>
	 */
var qt=new RegExp("");qt.compile("[^0-9a-f]","gi"),ut.prototype.signWithMessageHash=vt,ut.prototype.signString=yt,ut.prototype.signStringWithSHA1=St,ut.prototype.signStringWithSHA256=At,ut.prototype.sign=yt,ut.prototype.signWithSHA1=St,ut.prototype.signWithSHA256=At,ut.prototype.signWithMessageHashPSS=wt,ut.prototype.signStringPSS=Et,ut.prototype.signPSS=Et,ut.SALT_LEN_HLEN=-1,ut.SALT_LEN_MAX=-2,ut.prototype.verifyWithMessageHash=Dt,ut.prototype.verifyString=Rt,ut.prototype.verifyHexSignatureForMessage=Ct,ut.prototype.verify=Rt,ut.prototype.verifyHexSignatureForByteArrayMessage=Ct,ut.prototype.verifyWithMessageHashPSS=Ot,ut.prototype.verifyStringPSS=Nt,ut.prototype.verifyPSS=Nt,ut.SALT_LEN_RECOVER=-2,t.exports=Ut,t.exports.KEYUTIL=Wt}).call(e,r(1).Buffer)},function(t,e,r){(function(t,n){/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */
"use strict";function i(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}function o(){return t.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,r){if(o()<r)throw new RangeError("Invalid typed array length");return t.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(r),e.__proto__=t.prototype):(null===e&&(e=new t(r)),e.length=r),e}function t(e,r,n){if(!(t.TYPED_ARRAY_SUPPORT||this instanceof t))return new t(e,r,n);if("number"==typeof e){if("string"==typeof r)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}return a(this,e,r,n)}function a(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?l(t,e,r,n):"string"==typeof e?c(t,e,r):g(t,e)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function f(t,e,r,n){return h(e),e<=0?s(t,e):void 0!==r?"string"==typeof n?s(t,e).fill(r,n):s(t,e).fill(r):s(t,e)}function u(e,r){if(h(r),e=s(e,r<0?0:0|d(r)),!t.TYPED_ARRAY_SUPPORT)for(var n=0;n<r;++n)e[n]=0;return e}function c(e,r,n){if("string"==typeof n&&""!==n||(n="utf8"),!t.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|v(r,n);e=s(e,i);var o=e.write(r,n);return o!==i&&(e=e.slice(0,o)),e}function p(t,e){var r=e.length<0?0:0|d(e.length);t=s(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function l(e,r,n,i){if(r.byteLength,n<0||r.byteLength<n)throw new RangeError("'offset' is out of bounds");if(r.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");return r=void 0===n&&void 0===i?new Uint8Array(r):void 0===i?new Uint8Array(r,n):new Uint8Array(r,n,i),t.TYPED_ARRAY_SUPPORT?(e=r,e.__proto__=t.prototype):e=p(e,r),e}function g(e,r){if(t.isBuffer(r)){var n=0|d(r.length);return e=s(e,n),0===e.length?e:(r.copy(e,0,0,n),e)}if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||z(r.length)?s(e,0):p(e,r);if("Buffer"===r.type&&Q(r.data))return p(e,r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function d(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function y(e){return+e!=e&&(e=0),t.alloc(+e)}function v(e,r){if(t.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(r){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return X(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return q(e).length;default:if(i)return X(e).length;r=(""+r).toLowerCase(),i=!0}}function S(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if(r>>>=0,e>>>=0,r<=e)return"";for(t||(t="utf8");;)switch(t){case"hex":return j(this,e,r);case"utf8":case"utf-8":return D(this,e,r);case"ascii":return O(this,e,r);case"latin1":case"binary":return K(this,e,r);case"base64":return R(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function A(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function m(e,r,n,i,o){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof r&&(r=t.from(r,i)),t.isBuffer(r))return 0===r.length?-1:E(e,r,n,i,o);if("number"==typeof r)return r&=255,t.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,r,n):Uint8Array.prototype.lastIndexOf.call(e,r,n):E(e,[r],n,i,o);throw new TypeError("val must be string, number or Buffer")}function E(t,e,r,n,i){function o(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}var s=1,a=t.length,h=e.length;if(void 0!==n&&(n=String(n).toLowerCase(),"ucs2"===n||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,h/=2,r/=2}var f;if(i){var u=-1;for(f=r;f<a;f++)if(o(t,f)===o(e,u===-1?0:f-u)){if(u===-1&&(u=f),f-u+1===h)return u*s}else u!==-1&&(f-=f-u),u=-1}else for(r+h>a&&(r=a-h),f=r;f>=0;f--){for(var c=!0,p=0;p<h;p++)if(o(t,f+p)!==o(e,p)){c=!1;break}if(c)return f}return-1}function w(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;var o=e.length;if(o%2!==0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[r+s]=a}return s}function P(t,e,r,n){return G(X(e,t.length-r),t,r,n)}function b(t,e,r,n){return G(J(e),t,r,n)}function H(t,e,r,n){return b(t,e,r,n)}function x(t,e,r,n){return G(q(e),t,r,n)}function C(t,e,r,n){return G(W(e,t.length-r),t,r,n)}function R(t,e,r){return 0===e&&r===t.length?$.fromByteArray(t):$.fromByteArray(t.slice(e,r))}function D(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var o=t[i],s=null,a=o>239?4:o>223?3:o>191?2:1;if(i+a<=r){var h,f,u,c;switch(a){case 1:o<128&&(s=o);break;case 2:h=t[i+1],128===(192&h)&&(c=(31&o)<<6|63&h,c>127&&(s=c));break;case 3:h=t[i+1],f=t[i+2],128===(192&h)&&128===(192&f)&&(c=(15&o)<<12|(63&h)<<6|63&f,c>2047&&(c<55296||c>57343)&&(s=c));break;case 4:h=t[i+1],f=t[i+2],u=t[i+3],128===(192&h)&&128===(192&f)&&128===(192&u)&&(c=(15&o)<<18|(63&h)<<12|(63&f)<<6|63&u,c>65535&&c<1114112&&(s=c))}}null===s?(s=65533,a=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),i+=a}return N(n)}function N(t){var e=t.length;if(e<=tt)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=tt));return r}function O(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function K(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function j(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=e;o<r;++o)i+=Y(t[o]);return i}function T(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function I(t,e,r){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function M(e,r,n,i,o,s){if(!t.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>o||r<s)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function _(t,e,r,n){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-r,2);i<o;++i)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function B(t,e,r,n){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-r,4);i<o;++i)t[r+i]=e>>>8*(n?i:3-i)&255}function k(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function U(t,e,r,n,i){return i||k(t,e,r,4,3.4028234663852886e38,-3.4028234663852886e38),Z.write(t,e,r,n,23,4),r+4}function F(t,e,r,n,i){return i||k(t,e,r,8,1.7976931348623157e308,-1.7976931348623157e308),Z.write(t,e,r,n,52,8),r+8}function V(t){if(t=L(t).replace(et,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function L(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function Y(t){return t<16?"0"+t.toString(16):t.toString(16)}function X(t,e){e=e||1/0;for(var r,n=t.length,i=null,o=[],s=0;s<n;++s){if(r=t.charCodeAt(s),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function J(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}function W(t,e){for(var r,n,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)r=t.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}function q(t){return $.toByteArray(V(t))}function G(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function z(t){return t!==t}var $=r(2),Z=r(3),Q=r(4);e.Buffer=t,e.SlowBuffer=y,e.INSPECT_MAX_BYTES=50,t.TYPED_ARRAY_SUPPORT=void 0!==n.TYPED_ARRAY_SUPPORT?n.TYPED_ARRAY_SUPPORT:i(),e.kMaxLength=o(),t.poolSize=8192,t._augment=function(e){return e.__proto__=t.prototype,e},t.from=function(t,e,r){return a(null,t,e,r)},t.TYPED_ARRAY_SUPPORT&&(t.prototype.__proto__=Uint8Array.prototype,t.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&t[Symbol.species]===t&&Object.defineProperty(t,Symbol.species,{value:null,configurable:!0})),t.alloc=function(t,e,r){return f(null,t,e,r)},t.allocUnsafe=function(t){return u(null,t)},t.allocUnsafeSlow=function(t){return u(null,t)},t.isBuffer=function(t){return!(null==t||!t._isBuffer)},t.compare=function(e,r){if(!t.isBuffer(e)||!t.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(e===r)return 0;for(var n=e.length,i=r.length,o=0,s=Math.min(n,i);o<s;++o)if(e[o]!==r[o]){n=e[o],i=r[o];break}return n<i?-1:i<n?1:0},t.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},t.concat=function(e,r){if(!Q(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return t.alloc(0);var n;if(void 0===r)for(r=0,n=0;n<e.length;++n)r+=e[n].length;var i=t.allocUnsafe(r),o=0;for(n=0;n<e.length;++n){var s=e[n];if(!t.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(i,o),o+=s.length}return i},t.byteLength=v,t.prototype._isBuffer=!0,t.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)A(this,e,e+1);return this},t.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)A(this,e,e+3),A(this,e+1,e+2);return this},t.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)A(this,e,e+7),A(this,e+1,e+6),A(this,e+2,e+5),A(this,e+3,e+4);return this},t.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?D(this,0,t):S.apply(this,arguments)},t.prototype.equals=function(e){if(!t.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===t.compare(this,e)},t.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},t.prototype.compare=function(e,r,n,i,o){if(!t.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===r&&(r=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),r<0||n>e.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&r>=n)return 0;if(i>=o)return-1;if(r>=n)return 1;if(r>>>=0,n>>>=0,i>>>=0,o>>>=0,this===e)return 0;for(var s=o-i,a=n-r,h=Math.min(s,a),f=this.slice(i,o),u=e.slice(r,n),c=0;c<h;++c)if(f[c]!==u[c]){s=f[c],a=u[c];break}return s<a?-1:a<s?1:0},t.prototype.includes=function(t,e,r){return this.indexOf(t,e,r)!==-1},t.prototype.indexOf=function(t,e,r){return m(this,t,e,r,!0)},t.prototype.lastIndexOf=function(t,e,r){return m(this,t,e,r,!1)},t.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return w(this,t,e,r);case"utf8":case"utf-8":return P(this,t,e,r);case"ascii":return b(this,t,e,r);case"latin1":case"binary":return H(this,t,e,r);case"base64":return x(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},t.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var tt=4096;t.prototype.slice=function(e,r){var n=this.length;e=~~e,r=void 0===r?n:~~r,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),r<0?(r+=n,r<0&&(r=0)):r>n&&(r=n),r<e&&(r=e);var i;if(t.TYPED_ARRAY_SUPPORT)i=this.subarray(e,r),i.__proto__=t.prototype;else{var o=r-e;i=new t(o,void 0);for(var s=0;s<o;++s)i[s]=this[s+e]}return i},t.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||I(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n},t.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||I(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},t.prototype.readUInt8=function(t,e){return e||I(t,1,this.length),this[t]},t.prototype.readUInt16LE=function(t,e){return e||I(t,2,this.length),this[t]|this[t+1]<<8},t.prototype.readUInt16BE=function(t,e){return e||I(t,2,this.length),this[t]<<8|this[t+1]},t.prototype.readUInt32LE=function(t,e){return e||I(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},t.prototype.readUInt32BE=function(t,e){return e||I(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},t.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||I(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*e)),n},t.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||I(t,e,this.length);for(var n=e,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*e)),o},t.prototype.readInt8=function(t,e){return e||I(t,1,this.length),128&this[t]?(255-this[t]+1)*-1:this[t]},t.prototype.readInt16LE=function(t,e){e||I(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},t.prototype.readInt16BE=function(t,e){e||I(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},t.prototype.readInt32LE=function(t,e){return e||I(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},t.prototype.readInt32BE=function(t,e){return e||I(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},t.prototype.readFloatLE=function(t,e){return e||I(t,4,this.length),Z.read(this,t,!0,23,4)},t.prototype.readFloatBE=function(t,e){return e||I(t,4,this.length),Z.read(this,t,!1,23,4)},t.prototype.readDoubleLE=function(t,e){return e||I(t,8,this.length),Z.read(this,t,!0,52,8)},t.prototype.readDoubleBE=function(t,e){return e||I(t,8,this.length),Z.read(this,t,!1,52,8)},t.prototype.writeUIntLE=function(t,e,r,n){if(t=+t,e|=0,r|=0,!n){var i=Math.pow(2,8*r)-1;M(this,t,e,r,i,0)}var o=1,s=0;for(this[e]=255&t;++s<r&&(o*=256);)this[e+s]=t/o&255;return e+r},t.prototype.writeUIntBE=function(t,e,r,n){if(t=+t,e|=0,r|=0,!n){var i=Math.pow(2,8*r)-1;M(this,t,e,r,i,0)}var o=r-1,s=1;for(this[e+o]=255&t;--o>=0&&(s*=256);)this[e+o]=t/s&255;return e+r},t.prototype.writeUInt8=function(e,r,n){return e=+e,r|=0,n||M(this,e,r,1,255,0),t.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[r]=255&e,r+1},t.prototype.writeUInt16LE=function(e,r,n){return e=+e,r|=0,n||M(this,e,r,2,65535,0),t.TYPED_ARRAY_SUPPORT?(this[r]=255&e,this[r+1]=e>>>8):_(this,e,r,!0),r+2},t.prototype.writeUInt16BE=function(e,r,n){return e=+e,r|=0,n||M(this,e,r,2,65535,0),t.TYPED_ARRAY_SUPPORT?(this[r]=e>>>8,this[r+1]=255&e):_(this,e,r,!1),r+2},t.prototype.writeUInt32LE=function(e,r,n){return e=+e,r|=0,n||M(this,e,r,4,4294967295,0),t.TYPED_ARRAY_SUPPORT?(this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=255&e):B(this,e,r,!0),r+4},t.prototype.writeUInt32BE=function(e,r,n){return e=+e,r|=0,n||M(this,e,r,4,4294967295,0),t.TYPED_ARRAY_SUPPORT?(this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=255&e):B(this,e,r,!1),r+4},t.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);M(this,t,e,r,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<r&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+r},t.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);M(this,t,e,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+r},t.prototype.writeInt8=function(e,r,n){return e=+e,r|=0,n||M(this,e,r,1,127,-128),t.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[r]=255&e,r+1},t.prototype.writeInt16LE=function(e,r,n){return e=+e,r|=0,n||M(this,e,r,2,32767,-32768),t.TYPED_ARRAY_SUPPORT?(this[r]=255&e,this[r+1]=e>>>8):_(this,e,r,!0),r+2},t.prototype.writeInt16BE=function(e,r,n){return e=+e,r|=0,n||M(this,e,r,2,32767,-32768),t.TYPED_ARRAY_SUPPORT?(this[r]=e>>>8,this[r+1]=255&e):_(this,e,r,!1),r+2},t.prototype.writeInt32LE=function(e,r,n){return e=+e,r|=0,n||M(this,e,r,4,2147483647,-2147483648),t.TYPED_ARRAY_SUPPORT?(this[r]=255&e,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24):B(this,e,r,!0),r+4},t.prototype.writeInt32BE=function(e,r,n){return e=+e,r|=0,n||M(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),t.TYPED_ARRAY_SUPPORT?(this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=255&e):B(this,e,r,!1),r+4},t.prototype.writeFloatLE=function(t,e,r){return U(this,t,e,!0,r)},t.prototype.writeFloatBE=function(t,e,r){return U(this,t,e,!1,r)},t.prototype.writeDoubleLE=function(t,e,r){return F(this,t,e,!0,r)},t.prototype.writeDoubleBE=function(t,e,r){return F(this,t,e,!1,r)},t.prototype.copy=function(e,r,n,i){if(n||(n=0),i||0===i||(i=this.length),r>=e.length&&(r=e.length),r||(r=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-r<i-n&&(i=e.length-r+n);var o,s=i-n;if(this===e&&n<r&&r<i)for(o=s-1;o>=0;--o)e[o+r]=this[o+n];else if(s<1e3||!t.TYPED_ARRAY_SUPPORT)for(o=0;o<s;++o)e[o+r]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+s),r);return s},t.prototype.fill=function(e,r,n,i){if("string"==typeof e){if("string"==typeof r?(i=r,r=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!t.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;r>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0);var s;if("number"==typeof e)for(s=r;s<n;++s)this[s]=e;else{var a=t.isBuffer(e)?e:X(new t(e,i).toString()),h=a.length;for(s=0;s<n-r;++s)this[s+r]=a[s%h]}return this};var et=/[^+\/0-9A-Za-z-_]/g}).call(e,r(1).Buffer,function(){return this}())},function(t,e){"use strict";function r(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[e-2]?2:"="===t[e-1]?1:0}function n(t){return 3*t.length/4-r(t)}function i(t){var e,n,i,o,s,a=t.length;o=r(t),s=new u(3*a/4-o),n=o>0?a-4:a;var h=0;for(e=0;e<n;e+=4)i=f[t.charCodeAt(e)]<<18|f[t.charCodeAt(e+1)]<<12|f[t.charCodeAt(e+2)]<<6|f[t.charCodeAt(e+3)],s[h++]=i>>16&255,s[h++]=i>>8&255,s[h++]=255&i;return 2===o?(i=f[t.charCodeAt(e)]<<2|f[t.charCodeAt(e+1)]>>4,s[h++]=255&i):1===o&&(i=f[t.charCodeAt(e)]<<10|f[t.charCodeAt(e+1)]<<4|f[t.charCodeAt(e+2)]>>2,s[h++]=i>>8&255,s[h++]=255&i),s}function o(t){return h[t>>18&63]+h[t>>12&63]+h[t>>6&63]+h[63&t]}function s(t,e,r){for(var n,i=[],s=e;s<r;s+=3)n=(t[s]<<16)+(t[s+1]<<8)+t[s+2],i.push(o(n));return i.join("")}function a(t){for(var e,r=t.length,n=r%3,i="",o=[],a=16383,f=0,u=r-n;f<u;f+=a)o.push(s(t,f,f+a>u?u:f+a));return 1===n?(e=t[r-1],i+=h[e>>2],i+=h[e<<4&63],i+="=="):2===n&&(e=(t[r-2]<<8)+t[r-1],i+=h[e>>10],i+=h[e>>4&63],i+=h[e<<2&63],i+="="),o.push(i),o.join("")}e.byteLength=n,e.toByteArray=i,e.fromByteArray=a;for(var h=[],f=[],u="undefined"!=typeof Uint8Array?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=0,l=c.length;p<l;++p)h[p]=c[p],f[c.charCodeAt(p)]=p;f["-".charCodeAt(0)]=62,f["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,r,n,i){var o,s,a=8*i-n-1,h=(1<<a)-1,f=h>>1,u=-7,c=r?i-1:0,p=r?-1:1,l=t[e+c];for(c+=p,o=l&(1<<-u)-1,l>>=-u,u+=a;u>0;o=256*o+t[e+c],c+=p,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=n;u>0;s=256*s+t[e+c],c+=p,u-=8);if(0===o)o=1-f;else{if(o===h)return s?NaN:(l?-1:1)*(1/0);s+=Math.pow(2,n),o-=f}return(l?-1:1)*s*Math.pow(2,o-n)},e.write=function(t,e,r,n,i,o){var s,a,h,f=8*o-i-1,u=(1<<f)-1,c=u>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,l=n?0:o-1,g=n?1:-1,d=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-s))<1&&(s--,h*=2),e+=s+c>=1?p/h:p*Math.pow(2,1-c),e*h>=2&&(s++,h/=2),s+c>=u?(a=0,s=u):s+c>=1?(a=(e*h-1)*Math.pow(2,i),s+=c):(a=e*Math.pow(2,c-1)*Math.pow(2,i),s=0));i>=8;t[r+l]=255&a,l+=g,a/=256,i-=8);for(s=s<<i|a,f+=i;f>0;t[r+l]=255&s,l+=g,s/=256,f-=8);t[r+l-g]|=128*d}},function(t,e){var r={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}}])});
//# sourceMappingURL=jsrsasign.min.js.map